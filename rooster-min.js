var roosterjs=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=100)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(32);t.NodeBlockElement=r.default;var o=n(7);t.getBlockElementAtNode=o.default;var i=n(50);t.getFirstLastBlockElement=i.default;var a=n(48);t.StartEndBlockElement=a.default;var s=n(23);t.ContentTraverser=s.default;var l=n(108);t.PositionContentSearcher=l.default;var u=n(14);t.getInlineElementAtNode=u.default;var d=n(51);t.ImageInlineElement=d.default;var c=n(52);t.LinkInlineElement=c.default;var f=n(24);t.NodeInlineElement=f.default;var p=n(27);t.PartialInlineElement=p.default;var h=n(36);t.applyTextStyle=h.default;var v=n(56);t.Browser=v.Browser,t.getBrowserInfo=v.getBrowserInfo;var g=n(109);t.applyFormat=g.default;var m=n(39);t.changeElementTag=m.default;var y=n(21);t.collapseNodes=y.default;var E=n(3);t.contains=E.default;var b=n(110);t.extractClipboardEvent=b.default;var S=n(12);t.findClosestElementAncestor=S.default;var C=n(49);t.fromHtml=C.default;var O=n(26);t.getComputedStyles=O.default,t.getComputedStyle=O.getComputedStyle;var N=n(111);t.getPendableFormatState=N.default,t.PendableFormatCommandMap=N.PendableFormatCommandMap;var w=n(1);t.getTagOfNode=w.default;var P=n(16);t.isBlockElement=P.default;var _=n(28);t.isNodeEmpty=_.default;var T=n(112);t.isRtl=T.default;var A=n(34);t.isVoidHtmlElement=A.default;var L=n(113);t.matchLink=L.default;var I=n(114);t.adjustNodeInsertPosition=I.default;var k=n(29);t.queryElements=k.default;var D=n(11);t.splitParentNode=D.default,t.splitBalancedNodeRange=D.splitBalancedNodeRange;var M=n(30);t.unwrap=M.default;var x=n(13);t.wrap=x.default;var R=n(5);t.getNextLeafSibling=R.getNextLeafSibling,t.getPreviousLeafSibling=R.getPreviousLeafSibling;var B=n(54);t.getFirstLeafNode=B.getFirstLeafNode,t.getLastLeafNode=B.getLastLeafNode;var F=n(115);t.getTextContent=F.default;var j=n(37);t.splitTextNode=j.default;var U=n(8);t.toArray=U.default;var H=n(58);t.VTable=H.default;var z=n(61);t.VList=z.default;var W=n(117);t.createVListFromRegion=W.default;var q=n(118);t.getRegionsFromRange=q.default;var V=n(62);t.getSelectedBlockElementsInRegion=V.default;var K=n(120);t.collapseNodesInRegion=K.default;var G=n(41);t.isNodeInRegion=G.default;var X=n(4);t.Position=X.default;var Y=n(9);t.createRange=Y.default,t.getRangeFromSelectionPath=Y.getRangeFromSelectionPath;var Q=n(121);t.getPositionRect=Q.default;var $=n(57);t.isPositionAtBeginningOf=$.default;var J=n(63);t.getSelectionPath=J.default;var Z=n(122);t.getHtmlWithSelectionPath=Z.default;var ee=n(123);t.setHtmlWithSelectionPath=ee.default;var te=n(124);t.addSnapshot=te.default;var ne=n(42);t.canMoveCurrentSnapshot=ne.default;var re=n(64);t.clearProceedingSnapshots=re.default;var oe=n(125);t.moveCurrentSnapsnot=oe.default;var ie=n(126);t.createSnapshots=ie.default;var ae=n(127);t.HtmlSanitizer=ae.default;var se=n(66);t.htmlToDom=se.default,t.splitWithFragment=se.splitWithFragment;var le=n(65);t.getInheritableStyles=le.default;var ue=n(129);t.createDefaultHtmlSanitizerOptions=ue.default;var de=n(130);t.chainSanitizerCallback=de.default;var ce=n(131);t.isDocumentFragment=ce.default;var fe=n(35);t.isHTMLElement=fe.default;var pe=n(132);t.isHTMLOListElement=pe.default;var he=n(59);t.isHTMLTableCellElement=he.default;var ve=n(60);t.isHTMLTableElement=ve.default;var ge=n(22);t.isNode=ge.default;var me=n(33);t.isRange=me.default;var ye=n(6);t.safeInstanceOf=ye.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e&&1==e.nodeType?e.tagName.toUpperCase():""}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(139);t.Editor=r.default;var o=n(86);t.Undo=o.default;var i=n(80);t.EditPlugin=i.default;var a=n(84);t.MouseUpPlugin=a.default;var s=n(79);t.DOMEventPlugin=s.default;var l=n(85);t.TypeInContainerPlugin=l.default;var u=n(81);t.FirefoxTypeAfterLink=u.default;var d=n(76);t.CopyPlugin=d.default;var c=n(78);t.CorePastePlugin=c.default;var f=n(44);t.cacheGetEventData=f.default;var p=n(83);t.clearEventDataCache=p.default;var h=n(82);t.cacheGetContentSearcher=h.cacheGetContentSearcher,t.clearContentSearcherCache=h.clearContentSearcherCache;var v=n(155);t.cacheGetElementAtCursor=v.default;var g=n(88);t.isModifierKey=g.default;var m=n(87);t.isCharacterValue=m.default;var y=n(43);t.isCtrlOrMetaPressed=y.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(33);t.default=function(e,t,n){return!(!e||!t)&&(!(!n||e!=t)||(r.default(t)&&(t=t&&t.commonAncestorContainer,n=!0),t&&3==t.nodeType&&(t=t.parentNode,n=!0),1!=e.nodeType&&11!=e.nodeType?!!n&&e==t:!(!n&&e==t)&&e.contains(t)))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(12),o=n(15),i=function(){function e(e,t,n){switch(this.isFromEndOfRange=n,e.node?(this.node=e.node,t=e.offset):this.node=e,t){case-2:this.offset=a(this.node),this.node=this.node.parentNode,this.isAtEnd=!1;break;case-3:this.offset=a(this.node)+1,this.isAtEnd=!this.node.nextSibling,this.node=this.node.parentNode;break;case-1:this.offset=s(this.node),this.isAtEnd=!0;break;default:var o=s(this.node);this.offset=Math.max(0,Math.min(t,o)),this.isAtEnd=t>0&&t>=o}this.element=r.default(this.node)}return e.prototype.normalize=function(){if(3==this.node.nodeType||!this.node.firstChild)return this;for(var t=this.node,n=this.isAtEnd?-1:this.offset;1==t.nodeType;){var r=this.isFromEndOfRange?-1==n?t.lastChild:t.childNodes[n-1]:0==n?t.firstChild:-1==n?t.lastChild:t.childNodes[n];if(!r)break;t=r,n=this.isAtEnd||this.isFromEndOfRange?-1:0}return new e(t,n,this.isFromEndOfRange)},e.prototype.equalTo=function(e){return e&&(this==e||this.node==e.node&&this.offset==e.offset&&this.isAtEnd==e.isAtEnd)},e.prototype.isAfter=function(e){return this.node==e.node?this.isAtEnd&&!e.isAtEnd||this.offset>e.offset:o.default(this.node,e.node)},e.prototype.move=function(t){return new e(this.node,Math.max(this.offset+t,0))},e.getStart=function(t){return new e(t.startContainer,t.startOffset)},e.getEnd=function(t){return t.collapsed?e.getStart(t):new e(t.endContainer,t.endOffset,!0)},e}();function a(e){for(var t=0;e=e.previousSibling;)t++;return t}function s(e){return 3==e.nodeType?e.nodeValue.length:1==e.nodeType?e.childNodes.length:1}t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o=n(1),i=n(25);function a(e,t,n,a,s){var l=null,u=n?function(e){return e.nextSibling}:function(e){return e.previousSibling},d=n?function(e){return e.firstChild}:function(e){return e.lastChild};if(r.default(e,t))for(var c=t,f=!0;f;){var p=c.parentNode;for(c=u(c);!c&&p!=e;)c=u(p),p=p.parentNode;for(;c&&(!a||a.indexOf(o.default(c))<0)&&d(c);)c=d(c);if(!(f=c&&i.default(c,s))){l=c;break}}return l}t.getLeafSibling=a,t.getNextLeafSibling=function(e,t,n){return a(e,t,!0,n)},t.getPreviousLeafSibling=function(e,t,n){return a(e,t,!1,n)}},function(e,t,n){"use strict";function r(e){var t=e&&(e.commonAncestorContainer||e),n=t&&(t.ownerDocument||("[object HTMLDocument]"==Object.prototype.toString.apply(t)?t:null));return n&&(n.defaultView||window)}Object.defineProperty(t,"__esModule",{value:!0}),t.getTargetWindow=r,t.default=function(e,t){var n=r(e),o=n&&n[t],i=window,a=i&&i[t];return a&&e instanceof a||o&&e instanceof o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(21),o=n(3),i=n(1),a=n(16),s=n(32),l=n(48);function u(e,t,n){var r=e;if("BR"==i.default(r)&&n)return r;for(;r;){for(var o=e;!(o=n?e.nextSibling:e.previousSibling);)if((e=e.parentNode)==t)return r;for(;o;){if(a.default(o))return r;if("BR"==i.default(o))return n?o:r;e=o,o=n?e.firstChild:e.lastChild}r=e}return r}t.default=function(e,t){if(!o.default(e,t))return null;var n=l.default.getBlockContext(t);if(n==t)return new s.default(n);var i=u(t,n,!1),d=u(t,n,!0),c=r.default(e,i,d,!1);if(i=c[0],d=c[c.length-1],i.parentNode!=d.parentNode)return new l.default(e,i,d);for(;!i.previousSibling&&!d.nextSibling;){var f=i.parentNode;if(f==n){n!=e&&(i=d=f);break}i=d=f}return i==d&&a.default(i)?new s.default(i):new l.default(e,i,d)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return[].slice.call(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(22),o=n(34),i=n(4);function a(e,t,n,o){var a,d;if(l(e)?(a=e,d=l(t)?t:null):r.default(e)&&(Array.isArray(t)?(a=u(e,t),d=Array.isArray(n)?u(e,n):null):"number"==typeof t?(a=new i.default(e,t),d=r.default(n)?new i.default(n,o):null):!r.default(t)&&t||(a=new i.default(e,-2),d=new i.default(t||e,-3))),a&&a.node){var c=a.node.ownerDocument.createRange();return a=s(a),d=s(d||a),c.setStart(a.node,a.offset),c.setEnd(d.node,d.offset),c}return null}function s(e){return 1==e.node.nodeType&&o.default(e.node)?new i.default(e.node,e.isAtEnd?-3:-2):e}function l(e){return e&&e.node}function u(e,t){if(!e||!t)return null;for(var n,r=0;r<t.length&&(n=t[r],r<t.length-1&&e&&1==e.nodeType&&e.childNodes.length>n);r++)e=e.childNodes[n];return new i.default(e,n)}t.default=a,t.getRangeFromSelectionPath=function(e,t){return a(e,t.start,t.end)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=null;t.default=function(e,t){e.focus();var n=function(){return e.getDocument().execCommand(t,!1,null)},i=e.getSelectionRange();i&&i.collapsed?(e.addUndoSnapshot(),n(),function(e){o||(o=Object.keys(r.PendableFormatCommandMap).map((function(e){return r.PendableFormatCommandMap[e]})));return o.indexOf(e)>=0}(t)&&e.triggerPluginEvent(13,{formatState:r.getPendableFormatState(e.getDocument())})):e.addUndoSnapshot(n,"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(15);function o(e,t){if(!e||!e.parentNode)return null;var n=e.parentNode,r=n.cloneNode(!1);if(r.removeAttribute("id"),t)for(;n.firstChild&&n.firstChild!=e;)r.appendChild(n.firstChild);else for(;e.nextSibling;)r.appendChild(e.nextSibling);return r.firstChild&&""!=r.innerHTML?n.parentNode.insertBefore(r,t?n:n.nextSibling):r=null,r}t.default=o,t.splitBalancedNodeRange=function(e){var t=Array.isArray(e)?e[0]:e,n=Array.isArray(e)?e[e.length-1]:e,i=t&&n&&t.parentNode==n.parentNode?t.parentNode:null;if(i){if(r.default(t,n)){var a=n;n=t,t=a}o(t,!0),o(n,!1)}return i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3);t.default=function(e,t,n){var o=(e=e?1==e.nodeType?e:e.parentNode:null)&&1==e.nodeType?e:null;if(o&&n)if(o.closest)o=o.closest(n);else for(;o&&o!=t&&!(o.matches||o.msMatchesSelector).call(o,n);)o=o.parentElement;return!t||r.default(t,o)?o:null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(49),o=n(35),i=n(22);t.default=function(e,t){if(0==(e=e?i.default(e)?[e]:e:[]).length||!e[0])return null;if(!o.default(t)){var n=e[0].ownerDocument;t=/^\w+$/.test(t=t||"div")?n.createElement(t):r.default(t,n)[0]}var a=e[0].parentNode;a&&a.insertBefore(t,e[0]);for(var s=0,l=e;s<l.length;s++){var u=l[s];t.appendChild(u)}return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7),o=n(1),i=n(51),a=n(22),s=n(52),l=n(24);t.default=function(e,t){var n=a.default(e)?r.default(e,t):e;return t&&n&&function(e,t){for(var n,r=[e],a=e.parentNode;a&&t.contains(a);a=a.parentNode)r.push(a);for(var u=r.length-1;u>=0&&!n;u--){var d=r[u],c=o.default(d);"A"==c?n=new s.default(d,t):"IMG"==c&&(n=new i.default(d,t))}return n||new l.default(e,t)}(t,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return!(!e||!t||4!=(4&t.compareDocumentPosition(e)))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o="ADDRESS,ARTICLE,ASIDE,BLOCKQUOTE,CANVAS,DD,DIV,DL,DT,FIELDSET,FIGCAPTION,FIGURE,FOOTER,FORM,H1,H2,H3,H4,H5,H6,HEADER,HR,LI,MAIN,NAV,NOSCRIPT,OL,OUTPUT,P,PRE,SECTION,TABLE,TD,TH,TFOOT,UL,VIDEO".split(","),i=["block","list-item","table-cell"];t.default=function(e){var t=r.default(e);return!(!t||!(i.indexOf(e.style.display)>=0||o.indexOf(t)>=0))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(134);t.changeFontSize=r.default,t.FONT_SIZES=r.FONT_SIZES;var o=n(135);t.clearBlockFormat=o.default,t.TAGS_TO_UNWRAP=o.TAGS_TO_UNWRAP,t.TAGS_TO_STOP_UNWRAP=o.TAGS_TO_STOP_UNWRAP,t.ATTRIBUTES_TO_PRESERVE=o.ATTRIBUTES_TO_PRESERVE;var i=n(136);t.clearFormat=i.default;var a=n(137);t.createLink=a.default;var s=n(138);t.getFormatState=s.default,t.getElementBasedFormatState=s.getElementBasedFormatState,t.getStyleBasedFormatState=s.getStyleBasedFormatState;var l=n(156);t.insertImage=l.default;var u=n(157);t.insertTable=u.default;var d=n(158);t.editTable=d.default;var c=n(159);t.formatTable=c.default;var f=n(160);t.removeLink=f.default;var p=n(161);t.replaceWithNode=p.default;var h=n(162);t.setAlignment=h.default;var v=n(69);t.setBackgroundColor=v.default;var g=n(72);t.setTextColor=g.default;var m=n(163);t.setDirection=m.default;var y=n(70);t.setFontName=y.default;var E=n(71);t.setFontSize=E.default;var b=n(164);t.setImageAltText=b.default;var S=n(165);t.setIndentation=S.default;var C=n(73);t.toggleBold=C.default;var O=n(167);t.toggleBullet=O.default;var N=n(74);t.toggleItalic=N.default;var w=n(168);t.toggleNumbering=w.default;var P=n(169);t.toggleBlockQuote=P.default;var _=n(170);t.toggleCodeBlock=_.default;var T=n(171);t.toggleStrikethrough=T.default;var A=n(172);t.toggleSubscript=A.default;var L=n(173);t.toggleSuperscript=L.default;var I=n(75);t.toggleUnderline=I.default;var k=n(174);t.toggleHeader=k.default;var D=n(0);t.getPendableFormatState=D.getPendableFormatState},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e,t){e.focus();var n=e.getSelectionRange();if(n&&n.collapsed){var o=n.startContainer;if("SPAN"==r.getTagOfNode(o)&&(!o.firstChild||"BR"==r.getTagOfNode(o.firstChild)&&!o.firstChild.nextSibling))e.addUndoSnapshot(),t(o);else o&&3==o.nodeType&&"​"==o.nodeValue&&"SPAN"==r.getTagOfNode(o.parentNode)||(e.addUndoSnapshot(),o=e.getDocument().createTextNode("​"),n.insertNode(o)),r.applyTextStyle(o,t),e.select(o,-1)}else e.addUndoSnapshot((function(){for(var n,r,o=e.getSelectionTraverser(),i=o&&o.currentInlineElement;i;){var a=o.getNextInlineElement();i.applyStyle((function(e,o){t(e,o),n=n||e,r=e})),i=a}n&&r&&e.select(n,-2,r,-3)}),"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(97),o=/_\d{1,8}$/;function i(e){return r.default(e).map((function(e){return e.id}))}t.ALLOWED_CSS_CLASSES=["^_Entity$","^_EId_","^_EType_","^_EReadonly_"],t.serializeEntityInfo=function(e,t,n,r,a){return void 0===a&&(a=i(e)),"_Entity _EType_"+t+" _EId_"+function(e,t){for(var n=o.exec(e),r=n?e.substr(0,e.length-n[0].length):e,i="",a=n&&parseInt(n[1])||0;;a++)if(i=r+"_"+a,t.indexOf(i)<0){t.push(i);break}return i}(r||t,a)+" _EReadonly_"+(n?"1":"0")},t.deserialzeEntityInfo=function(e){var t,n=!1,r="",o=!1;return e&&e.split(" ").forEach((function(e){"_Entity"==e?n=!0:0==e.indexOf("_EType_")?t=e.substr("_EType_".length):0==e.indexOf("_EId_")?r=e.substr("_EId_".length):0==e.indexOf("_EReadonly_")&&(o="1"==e.substr("_EReadonly_".length))})),n&&t?{type:t,id:r,isReadonly:o}:null},t.getAllEntityIds=i,t.getEntitySelector=function(e,t){return"._Entity"+(e?"._EType_"+e:"")+(t?"._EId_"+t:"")}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(19);t.default=function(e){var t=o.deserialzeEntityInfo(null==e?void 0:e.className);return t?r({contentNode:e},t):null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o=n(11),i=n(8);function a(e,t,n,i,a){for(;t.parentNode!=e&&!r.default(t.parentNode,n);){if(i&&t.previousSibling||!i&&t.nextSibling){if(!a)break;o.default(t,i)}t=t.parentNode}return t}t.default=function(e,t,n,o){if(!r.default(e,t)||!r.default(e,n))return[];if(t=a(e,t,n,!0,o),n=a(e,n,t,!1,o),r.default(t,n,!0))return[t];if(r.default(n,t))return[n];if(t.parentNode==n.parentNode){var s=i.default(t.parentNode.childNodes),l=s.indexOf(t),u=s.indexOf(n);return s.slice(l,u+1)}return[t,n]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6);t.default=function(e){return r.default(e,"Node")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(105),o=n(55),i=n(7),a=n(14),s=n(27),l=n(106),u=n(107),d=n(38),c=n(5),f=function(){function e(e,t){this.scoper=e,this.skipTags=t}return e.createBodyTraverser=function(t,n,o){return new e(new r.default(t,n))},e.createSelectionTraverser=function(t,n,r){return new e(new u.default(t,n),r)},e.createBlockTraverser=function(t,n,r,o){return void 0===r&&(r=3),new e(new l.default(t,n,r))},Object.defineProperty(e.prototype,"currentBlockElement",{get:function(){return this.currentBlock||(this.currentBlock=this.scoper.getStartBlockElement()),this.currentBlock},enumerable:!0,configurable:!0}),e.prototype.getNextBlockElement=function(){return this.getPreviousNextBlockElement(!0)},e.prototype.getPreviousBlockElement=function(){return this.getPreviousNextBlockElement(!1)},e.prototype.getPreviousNextBlockElement=function(e){var t=this.currentBlockElement;if(!t)return null;var n=c.getLeafSibling(this.scoper.rootNode,e?t.getEndNode():t.getStartNode(),e,this.skipTags),r=n?i.default(this.scoper.rootNode,n):null;return r&&this.scoper.isBlockInScope(r)&&(e&&r.isAfter(t)||!e&&t.isAfter(r))?(this.currentBlock=r,this.currentBlock):null},Object.defineProperty(e.prototype,"currentInlineElement",{get:function(){return this.currentInline||(this.currentInline=this.scoper.getStartInlineElement()),this.currentInline instanceof o.default?null:this.currentInline},enumerable:!0,configurable:!0}),e.prototype.getNextInlineElement=function(){return this.getPreviousNextInlineElement(!0)},e.prototype.getPreviousInlineElement=function(){return this.getPreviousNextInlineElement(!1)},e.prototype.getPreviousNextInlineElement=function(e){var t,n=this.currentInlineElement||this.currentInline;return n?(n instanceof o.default?(t=d.getInlineElementBeforeAfter(this.scoper.rootNode,n.getStartPosition(),e))&&!n.getParentBlock().contains(t.getContainerNode())&&(t=null):t=(t=function(e,t,n){if(!t)return null;if(t instanceof s.default){var r=n?t.nextInlineElement:t.previousInlineElement;if(r)return r}var o=t.getContainerNode();return o=c.getLeafSibling(e,o,n),a.default(e,o)}(this.scoper.rootNode,n,e))&&n&&(e&&t.isAfter(n)||!e&&n.isAfter(t))?t:null,t&&(t=this.scoper.trimInlineElement(t))?(this.currentInline=t,this.currentInline):null):null},e}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(36),o=n(15),i=n(4),a=function(){function e(e,t){this.containerNode=e,this.parentBlock=t}return e.prototype.getTextContent=function(){return 3==this.containerNode.nodeType?this.containerNode.nodeValue:this.containerNode.textContent},e.prototype.getContainerNode=function(){return this.containerNode},e.prototype.getParentBlock=function(){return this.parentBlock},e.prototype.getStartPosition=function(){return new i.default(this.containerNode,0).normalize()},e.prototype.getEndPosition=function(){return new i.default(this.containerNode,-1).normalize()},e.prototype.isTextualInlineElement=function(){return this.containerNode&&3==this.containerNode.nodeType},e.prototype.isAfter=function(e){return e&&o.default(this.containerNode,e.getContainerNode())},e.prototype.contains=function(e){var t=this.getStartPosition(),n=this.getEndPosition();return e&&e.isAfter(t)&&n.isAfter(e)},e.prototype.applyStyle=function(e){r.default(this.containerNode,e)},e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(26),i=/^[\r\n]+$/gm,a=/[\t\r\n\u0020\u200B]/gm;t.default=function e(t,n){if(3==t.nodeType)return!(t.nodeValue&&""!=t.textContent&&!i.test(t.nodeValue))||!(!n||""!=t.nodeValue.replace(a,""));if(1==t.nodeType){if("none"==o.getComputedStyle(t,"display"))return!0;var s=r.default(t);if("DIV"==s||"SPAN"==s){for(var l=t.firstChild;l;l=l.nextSibling)if(!e(l,n))return!1;return!0}return!1}return!0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(12);function o(e,t){void 0===t&&(t=["font-family","font-size","color","background-color"]);var n=r.default(e),o=[];if(t=Array.isArray(t)?t:[t],n){var a=(n.ownerDocument.defaultView||window).getComputedStyle(n);if(a)for(var s=0,l=t;s<l.length;s++){var u=l[s],d=(a.getPropertyValue(u)||"").toLowerCase();d="font-size"==u?i(d):d,o.push(d)}}return o}function i(e){return e&&e.indexOf("px")==e.length-2?Math.round(75*parseFloat(e)+.05)/100+"pt":e}t.default=o,t.getComputedStyle=function(e,t){return o(e,t)[0]||""}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(36),o=n(9),i=n(4),a=n(5),s=function(){function e(e,t,n){this.inlineElement=e,this.start=t,this.end=n}return e.prototype.getDecoratedInline=function(){return this.inlineElement},e.prototype.getContainerNode=function(){return this.inlineElement.getContainerNode()},e.prototype.getParentBlock=function(){return this.inlineElement.getParentBlock()},e.prototype.getTextContent=function(){return o.default(this.getStartPosition(),this.getEndPosition()).toString()},e.prototype.getStartPosition=function(){return this.start||this.inlineElement.getStartPosition()},e.prototype.getEndPosition=function(){return this.end||this.inlineElement.getEndPosition()},Object.defineProperty(e.prototype,"nextInlineElement",{get:function(){return this.end&&new e(this.inlineElement,this.end,null)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousInlineElement",{get:function(){return this.start&&new e(this.inlineElement,null,this.start)},enumerable:!0,configurable:!0}),e.prototype.contains=function(e){return e&&e.isAfter(this.getStartPosition())&&this.getEndPosition().isAfter(e)},e.prototype.isTextualInlineElement=function(){return this.inlineElement&&this.inlineElement.isTextualInlineElement()},e.prototype.isAfter=function(e){var t=this.getStartPosition(),n=e&&e.getEndPosition();return n&&(t.isAfter(n)||t.equalTo(n))},e.prototype.applyStyle=function(e){var t=this.getStartPosition().normalize(),n=this.getEndPosition().normalize(),o=this.getContainerNode();if(t.isAtEnd){var s=a.getNextLeafSibling(o,t.node);t=s?new i.default(s,0):null}if(0==n.offset){var l=a.getPreviousLeafSibling(o,n.node);n=l?new i.default(l,-1):null}r.default(o,e,t,n)},e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=["IMG"],i=["TABLE","IMG","LI"].join(","),a=/\u200b/g;function s(e,t){return e=e.replace(a,""),t?e.trim():e}t.default=function(e,t){if(!e)return!1;if(3==e.nodeType)return""==s(e.nodeValue,t);if(1==e.nodeType){var n=e;if(""!=s(n.textContent,t)||o.indexOf(r.default(n))>=0||n.querySelectorAll(i)[0])return!1}return!0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8);function o(e,t){return t.some((function(t){return 0==t?0==e:(e&t)==t}))}t.default=function(e,t,n,i,a){if(void 0===i&&(i=0),!e||!t)return[];var s=r.default(e.querySelectorAll(t));if(0!=i&&a){var l=a.startContainer,u=a.startOffset,d=a.endContainer,c=a.endOffset;if(1==l.nodeType&&l.firstChild){var f=l.childNodes[u];l=f||l.lastChild}d=1==d.nodeType&&d.firstChild&&c>0?d.childNodes[c-1]:d,s=s.filter((function(e){return function(e,t,n,r){var i=e.compareDocumentPosition(t),a=e.compareDocumentPosition(n),s=[0,8];r||s.push(16);return o(i,s)||o(a,s)||o(i,[2])&&o(a,[4])&&!o(a,[16])}(e,l,d,2==i)}))}return n&&s.forEach(n),s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e?e.parentNode:null;if(!t)return null;for(;e.firstChild;)t.insertBefore(e.firstChild,e);return t.removeChild(e),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(19);t.default=function(e,t){return t&&e.getElementAtCursor(r.getEntitySelector(),t)||null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o=n(15),i=function(){function e(e){this.element=e}return e.prototype.collapseToSingleElement=function(){return this.element},e.prototype.getStartNode=function(){return this.element},e.prototype.getEndNode=function(){return this.element},e.prototype.equals=function(e){return this.element==e.getStartNode()},e.prototype.isAfter=function(e){return o.default(this.element,e.getEndNode())},e.prototype.contains=function(e){return r.default(this.element,e,!0)},e.prototype.getTextContent=function(){return this.element?this.element.textContent:""},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6);t.default=function(e){return r.default(e,"Range")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o="AREA,BASE,BR,COL,COMMAND,EMBED,HR,IMG,INPUT,KEYGEN,LINK,META,PARAM,SOURCE,TRACK,WBR".split(",");t.default=function(e){return!!e&&o.indexOf(r.default(e))>=0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6);t.default=function(e){return r.default(e,"HTMLElement")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(4),i=n(37),a=n(13),s=n(5),l=n(11),u="SPAN,B,I,U,EM,STRONG,STRIKE,S,SMALL".split(",");function d(e,t){e&&1==e.nodeType&&t(e,!0)}t.default=function(e,t,n,c){void 0===n&&(n=new o.default(e,0).normalize()),void 0===c&&(c=new o.default(e,-1).normalize());for(var f=[];n&&c&&c.isAfter(n);){var p=n.node,h=r.default(p.parentNode),v=s.getNextLeafSibling(e,p);3==p.nodeType&&["TR","TABLE"].indexOf(h)<0&&(p!=c.node||c.isAtEnd||(p=i.default(p,c.offset,!0)),n.offset>0&&(p=i.default(p,n.offset,!1)),f.push(p)),n=v&&new o.default(v,0)}if(f.length>0){if(f.every((function(e){return e.parentNode==f[0].parentNode}))){var g=f.shift();f.forEach((function(e){g.nodeValue+=e.nodeValue,e.parentNode.removeChild(e)})),f=[g]}f.forEach((function(e){for(;"SPAN"!=r.default(e)&&u.indexOf(r.default(e.parentNode))>=0;)d(e,t),e=l.splitBalancedNodeRange(e);"SPAN"!=r.default(e)&&(d(e,t),e=a.default(e,"SPAN")),t(e)}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){var r=e.nodeValue.substr(0,t),o=e.nodeValue.substr(t),i=e.ownerDocument.createTextNode(n?r:o);return e.nodeValue=n?o:r,e.parentNode.insertBefore(i,n?e:e.nextSibling),i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(14),o=n(27),i=n(25),a=n(5);function s(e,t,n){if(!e||!t||!t.node)return null;var s=(t=t.normalize()).node,l=t.offset,u=t.isAtEnd,d=!1;!n&&0==l&&!u||n&&u?s=a.getLeafSibling(e,s,n):3==s.nodeType&&(!n&&!u||n&&l>0)&&(d=!0),s&&i.default(s)&&(s=a.getLeafSibling(e,s,n));var c=r.default(e,s);return c&&(d||c.contains(t))&&(c=n?new o.default(c,t,null):new o.default(c,null,t)),c}t.getInlineElementBefore=function(e,t){return s(e,t,!1)},t.getInlineElementAfter=function(e,t){return s(e,t,!0)},t.getInlineElementBeforeAfter=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(26),o=n(1);t.default=function(e,t){var n;if(!e||!t)return null;for(var i=e.ownerDocument.createElement(t),a=0;a<e.attributes.length;a++){var s=e.attributes[a];i.setAttribute(s.name,s.value)}for(;e.firstChild;)i.appendChild(e.firstChild);return"P"!=o.default(e)&&"P"!=o.default(i)||(n=r.default(e,["margin-top","margin-bottom"]),i.style.marginTop=n[0],i.style.marginBottom=n[1]),e.parentNode&&e.parentNode.replaceChild(i,e),i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1);function o(e){switch(r.default(e)){case"OL":return 1;case"UL":return 2;default:return 0}}t.default=o,t.isListElement=function(e){return 0!=o(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3);t.default=function(e,t){return!(!e||!r.default(e.rootNode,t)||e.nodeBefore&&4!=e.nodeBefore.compareDocumentPosition(t)||e.nodeAfter&&2!=e.nodeAfter.compareDocumentPosition(t))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=e.currentIndex+t;return n>=0&&n<e.snapshots.length}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0).Browser.isMac?function(e){return e.metaKey}:function(e){return e.ctrlKey};t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){var r=e&&e.eventDataCache&&e.eventDataCache.hasOwnProperty(t)?e.eventDataCache[t]:n();return e&&(e.eventDataCache=e.eventDataCache||{},e.eventDataCache[t]=r),r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e,t){var n=e.getElementAtCursor("OL,UL");if(r.Browser.isChrome&&"indent"!==t){var o=e.getElementAtCursor("LI");if(o){var i=e.getSelectionRange(),a=r.getSelectionPath(o,i);if(i&&(i.collapsed||e.getElementAtCursor("LI",i.startContainer)==o&&e.getElementAtCursor("LI",i.endContainer)==o))if("OL"===n.tagName&&"insertUnorderedList"===t||"UL"===n.tagName&&"insertOrderedList"===t)e.getDocument().execCommand(t,!1,null);else{var s=n.parentElement;if("OL"==s.tagName||"UL"==s.tagName)o.nextElementSibling&&r.splitBalancedNodeRange(o),n.insertAdjacentElement("afterend",o),e.select(r.createRange(o,a.start,a.end));else{o.nextElementSibling&&r.splitBalancedNodeRange(o);var l=r.wrap(r.toArray(o.childNodes)),u=r.createRange(l,a.start,a.end),d=r.getSelectionPath(l,u);n.insertAdjacentElement("afterend",l),e.deleteNode(o);var c=r.createRange(l,d.start,d.end);e.select(c)}0==n.childElementCount&&e.deleteNode(n)}else e.getDocument().execCommand(t,!1,null)}else e.getDocument().execCommand(t,!1,null)}else e.getDocument().execCommand(t,!1,null);var f=e.getElementAtCursor("OL,UL");return f==n&&(f=null),f}},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(102)),r(n(182)),r(n(185)),r(n(188)),r(n(191)),r(n(201)),r(n(204)),r(n(207)),r(n(210))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.getDefaultContentEditFeatures=function(){return{autoLink:!0,indentWhenTab:!0,outdentWhenShiftTab:!0,outdentWhenBackspaceOnEmptyFirstLine:!0,outdentWhenEnterOnEmptyLine:r.Browser.isIE||r.Browser.isChrome,mergeInNewLineWhenBackspaceOnFirstChar:!1,unquoteWhenBackspaceOnEmptyFirstLine:!0,unquoteWhenEnterOnEmptyLine:!0,autoBullet:!0,tabInTable:!0,upDownInTable:r.Browser.isChrome||r.Browser.isSafari,insertLineBeforeStructuredNodeFeature:!1,defaultShortcut:!0,unlinkWhenBackspaceAfterLink:!1,noCycleCursorMove:r.Browser.isChrome,smartOrderedList:!1,smartOrderedListStyles:["lower-alpha","lower-roman","decimal"],markdownBold:!0,markdownItalic:!0,markdownStrikethru:!0,markdownInlineCode:!0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(21),o=n(3),i=n(9),a=n(1),s=n(16),l=n(15),u=n(13),d=n(11),c=["TD","TH","LI","BLOCKQUOTE"],f=function(){function e(e,t,n){this.rootNode=e,this.startNode=t,this.endNode=n}return e.getBlockContext=function(e){for(;e&&!s.default(e);)e=e.parentNode;return e},e.prototype.collapseToSingleElement=function(){for(var t=r.default(e.getBlockContext(this.startNode),this.startNode,this.endNode,!0),n=e.getBlockContext(this.startNode);t[0]&&t[0]!=n&&t[0].parentNode!=this.rootNode&&c.indexOf(a.default(t[0].parentNode))<0;)t=[d.splitBalancedNodeRange(t)];return 1==t.length&&s.default(t[0])?t[0]:u.default(t)},e.prototype.getStartNode=function(){return this.startNode},e.prototype.getEndNode=function(){return this.endNode},e.prototype.equals=function(e){return this.startNode==e.getStartNode()&&this.endNode==e.getEndNode()},e.prototype.isAfter=function(e){return l.default(this.getStartNode(),e.getEndNode())},e.prototype.contains=function(e){return o.default(this.startNode,e,!0)||o.default(this.endNode,e,!0)||l.default(e,this.startNode)&&l.default(this.endNode,e)},e.prototype.getTextContent=function(){var e=i.default(this.getStartNode(),this.getEndNode());return e?e.toString():""},e}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8);t.default=function(e,t){var n=t.createElement("DIV");return n.innerHTML=e,r.default(n.childNodes)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7);function o(e,t){var n=e;do{n=n&&(t?n.firstChild:n.lastChild)}while(n&&n.firstChild);return n&&r.default(e,n)}t.default=o,t.getFirstBlockElement=function(e){return o(e,!0)},t.getLastBlockElement=function(e){return o(e,!1)}},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(t,n){return e.call(this,t,n)||this}return o(t,e),t}(n(24).default);t.default=i},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(t,n){return e.call(this,t,n)||this}return o(t,e),t}(n(24).default);t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(14),o=n(54);t.getFirstInlineElement=function(e){var t=o.getFirstLeafNode(e);return t?r.default(e,t):null},t.getLastInlineElement=function(e){var t=o.getLastLeafNode(e);return t?r.default(e,t):null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(25),o=n(5);function i(e,t){for(var n=function(e){return t?e.firstChild:e.lastChild},i=n(e);i&&n(i);)i=n(i);return i&&r.default(i)&&(i=o.getLeafSibling(e,i,t)),i}t.getFirstLeafNode=function(e){return i(e,!0)},t.getLastLeafNode=function(e){return i(e,!1)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this.position=e,this.parentBlock=t}return e.prototype.getTextContent=function(){return""},e.prototype.getContainerNode=function(){return this.position.node},e.prototype.getParentBlock=function(){return this.parentBlock},e.prototype.getStartPosition=function(){return this.position},e.prototype.getEndPosition=function(){return this.position},e.prototype.isAfter=function(e){return e&&this.position.isAfter(e.getEndPosition())},e.prototype.isTextualInlineElement=function(){return!1},e.prototype.contains=function(e){return!1},e.prototype.applyStyle=function(e){},e}();t.default=r},function(e,t,n){"use strict";function r(e,t){var n=-1!=e.indexOf("rv:")&&-1!=e.indexOf("Trident"),r=-1!=e.indexOf("MSIE")||n,o=!1,i=!1,a=!1,s=!1,l=-1!=e.indexOf("WebKit");return r||(o=-1!=e.indexOf("Chrome"),i=-1!=e.indexOf("Firefox"),-1!=e.indexOf("Safari")&&(a=-1==e.indexOf("Chrome")&&-1==e.indexOf("Android")),(s=-1!=e.indexOf("Edge"))&&(l=o=i=!1)),{isMac:-1!=t.indexOf("Mac"),isWin:-1!=t.indexOf("Win")||-1!=t.indexOf("NT"),isWebKit:l,isIE:r,isIE11OrGreater:n,isSafari:a,isChrome:o,isFirefox:i,isEdge:s,isIEOrEdge:r||s}}Object.defineProperty(t,"__esModule",{value:!0}),t.getBrowserInfo=r,t.Browser=window?r(window.navigator.userAgent,window.navigator.appVersion):{}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o=n(1),i=n(28);function a(e){for(;e.previousSibling;)if(e=e.previousSibling,"BR"==o.default(e)||!i.default(e))return!1;return!0}t.default=function(e,t){if(e){var n=e.normalize(),o=n.node;if(0==n.offset){for(;r.default(t,o)&&a(o);)o=o.parentNode;return o==t}}return!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(60),i=n(0),a=function(){function e(e){var t=this;if(this.trs=[],this.table=o.default(e)?e:function(e){for(var t=e;t&&"TABLE"!=t.tagName;t=t.parentElement);return t}(e),this.table){var n=o.default(e)?null:e,r=i.toArray(this.table.rows);this.cells=r.map((function(e){return[]})),r.forEach((function(e,r){t.trs[r%2]=e;for(var o=0,i=0;o<e.cells.length;o++){for(;t.cells[r][i];i++);var a=e.cells[o];a==n&&(t.col=i,t.row=r);for(var s=0;s<a.colSpan;s++,i++)for(var l=0;l<a.rowSpan;l++)t.cells[r+l][i]={td:s+l==0?a:null,spanLeft:s>0,spanAbove:l>0}}}))}}return e.prototype.writeBack=function(){var e=this;this.cells?(d(this.table),this.cells.forEach((function(t,n){var r=u(e.trs[n%2]||e.trs[0]);e.table.appendChild(r),t.forEach((function(t,o){t.td&&(e.recalcSpans(n,o),r.appendChild(t.td))}))}))):this.table&&this.table.parentNode.removeChild(this.table)},e.prototype.applyFormat=function(e){e&&this.table&&(this.table.style.borderCollapse="collapse",this.trs[0].style.backgroundColor=e.bgColorOdd||"transparent",this.trs[1]&&(this.trs[1].style.backgroundColor=e.bgColorEven||"transparent"),this.cells.forEach((function(t){return t.filter((function(e){return e.td})).forEach((function(t){t.td.style.borderTop=s(e.topBorderColor),t.td.style.borderBottom=s(e.bottomBorderColor),t.td.style.borderLeft=s(e.verticalBorderColor),t.td.style.borderRight=s(e.verticalBorderColor)}))})))},e.prototype.edit=function(e){var t=this;if(this.table){var n=this.cells[this.row],r=n[this.col];switch(e){case 0:this.cells.splice(this.row,0,n.map(l));break;case 1:var o=this.row+this.countSpanAbove(this.row,this.col);this.cells.splice(o,0,this.cells[o-1].map((function(e,n){var r=t.getCell(o,n);if(r.spanAbove)return l(r);if(e.spanLeft){var i=l(e);return i.spanAbove=!1,i}return{td:u(t.getTd(t.row,n))}})));break;case 2:this.forEachCellOfCurrentColumn((function(e,n){n.splice(t.col,0,l(e))}));break;case 3:var i=this.col+this.countSpanLeft(this.row,this.col);this.forEachCellOfColumn(i-1,(function(e,n,r){var o,a=t.getCell(r,i);a.spanLeft?o=l(a):e.spanAbove?(o=l(e)).spanLeft=!1:o={td:u(t.getTd(r,t.col))},n.splice(i,0,o)}));break;case 6:this.forEachCellOfCurrentRow((function(e,n){var r=t.getCell(t.row+1,n);e.td&&e.td.rowSpan>1&&r.spanAbove&&(r.td=e.td)})),this.cells.splice(this.row,1);break;case 5:this.forEachCellOfCurrentColumn((function(e,n,r){var o=t.getCell(r,t.col+1);e.td&&e.td.colSpan>1&&o.spanLeft&&(o.td=e.td),n.splice(t.col,1)}));break;case 7:case 8:for(var a=7==e?-1:1,s=this.row+a;s>=0&&s<this.cells.length;s+=a){if((v=this.getCell(s,this.col)).td&&!v.spanAbove){var c=s<this.row?v:r,f=s<this.row?r:v;c.td.colSpan==f.td.colSpan&&(d(f.td,c.td),f.td=null,f.spanAbove=!0);break}}break;case 9:case 10:for(var p=9==e?-1:1,h=this.col+p;h>=0&&h<this.cells[this.row].length;h+=p){var v;if((v=this.getCell(this.row,h)).td&&!v.spanLeft){var g=h<this.col?v:r,m=h<this.col?r:v;g.td.rowSpan==m.td.rowSpan&&(d(m.td,g.td),m.td=null,m.spanLeft=!0);break}}break;case 4:this.cells=null;break;case 12:if(r.td.rowSpan>1)this.getCell(this.row+1,this.col).td=u(r.td);else{var y=n.map((function(e){return{td:e==r?u(e.td):null,spanAbove:e!=r,spanLeft:e.spanLeft}}));this.cells.splice(this.row+1,0,y)}break;case 11:r.td.colSpan>1?this.getCell(this.row,this.col+1).td=u(r.td):this.forEachCellOfCurrentColumn((function(e,r){r.splice(t.col+1,0,{td:r==n?u(e.td):null,spanAbove:e.spanAbove,spanLeft:r!=n})}))}}},e.prototype.forEachCellOfCurrentColumn=function(e){this.forEachCellOfColumn(this.col,e)},e.prototype.forEachCellOfCurrentRow=function(e){this.forEachCellOfRow(this.row,e)},e.prototype.getCell=function(e,t){return this.cells&&this.cells[e]&&this.cells[e][t]||{}},e.prototype.getCurrentTd=function(){return this.getTd(this.row,this.col)},e.prototype.getTd=function(e,t){if(this.cells&&(e=Math.min(this.cells.length-1,e),t=this.cells[e]?Math.min(this.cells[e].length-1,t):t,!isNaN(e)&&!isNaN(t)))for(;e>=0&&t>=0;){var n=this.getCell(e,t);if(n.td)return n.td;if(n.spanLeft)t--;else{if(!n.spanAbove)break;e--}}return null},e.prototype.forEachCellOfColumn=function(e,t){for(var n=0;n<this.cells.length;n++)t(this.getCell(n,e),this.cells[n],n)},e.prototype.forEachCellOfRow=function(e,t){for(var n=0;n<this.cells[e].length;n++)t(this.getCell(e,n),n)},e.prototype.recalcSpans=function(e,t){var n=this.getCell(e,t).td;n&&(n.colSpan=this.countSpanLeft(e,t),n.rowSpan=this.countSpanAbove(e,t),1==n.colSpan&&n.removeAttribute("colSpan"),1==n.rowSpan&&n.removeAttribute("rowSpan"))},e.prototype.countSpanLeft=function(e,t){for(var n=1,r=t+1;r<this.cells[e].length;r++){var o=this.getCell(e,r);if(o.td||!o.spanLeft)break;n++}return n},e.prototype.countSpanAbove=function(e,t){for(var n=1,r=e+1;r<this.cells.length;r++){var o=this.getCell(r,t);if(o.td||!o.spanAbove)break;n++}return n},e}();function s(e){return"solid 1px "+(e||"transparent")}function l(e){return{td:u(e.td),spanAbove:e.spanAbove,spanLeft:e.spanLeft}}function u(e){var t=e?e.cloneNode(!1):null;return r.default(t)&&(t.removeAttribute("id"),t.firstChild||t.appendChild(e.ownerDocument.createElement("br"))),t}function d(e,t){for(;e.firstChild;)t?t.appendChild(e.firstChild):e.removeChild(e.firstChild)}t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6);t.default=function(e){return r.default(e,"HTMLTableCellElement")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6);t.default=function(e){return r.default(e,"HTMLTableElement")}},function(e,t,n){"use strict";var r=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r};Object.defineProperty(t,"__esModule",{value:!0});var o=n(39),i=n(40),a=n(1),s=n(16),l=n(28),u=n(4),d=n(29),c=n(11),f=n(8),p=n(30),h=n(116),v=n(13),g=function(){function e(e){if(this.rootList=e,this.items=[],!e)throw new Error("rootList must not be null");m(this.rootList),d.default(this.rootList,"ol,ul",m),d.default(this.rootList,"li",y),this.populateItems(this.rootList)}return e.prototype.contains=function(e){return this.items.some((function(t){return t.contains(e)}))},e.prototype.getFirstOrLastNode=function(e){var t=this.items[e?this.items.length-1:0];return null==t?void 0:t.getNode()},e.prototype.writeBack=function(){if(!this.rootList)throw new Error("rootList must not be null");var e=[this.rootList.ownerDocument.createDocumentFragment()];this.items.forEach((function(t){return t.writeBack(e)})),this.rootList.parentNode.replaceChild(e[0],this.rootList),this.rootList=null},e.prototype.setIndentation=function(e,t,n){this.findListItems(e,t,(function(e){return 1==n?e.outdent():e.indent()}))},e.prototype.changeListType=function(e,t,n){var r=!1;this.findListItems(e,t,(function(e){r=r||e.getListType()!=n})),this.findListItems(e,t,(function(e){return r?e.changeListType(n):e.outdent()}))},e.prototype.appendItem=function(e,t){var n=e,r=a.default(e);"LI"!=r&&"TABLE"!=r?n=o.default(e,"LI"):"TABLE"==r&&(n=v.default(e,"li")),this.items.push(0==t?new h.default(n):new h.default(n,t))},e.prototype.mergeVList=function(e){var t,n=this;if(e&&e!=this){var r=this.items.length;e.items.forEach((function(e){return n.items.push(e)})),e.items.splice(0,e.items.length),this.mergeOrphanNodesAfter(r-1),null===(t=e.rootList.parentNode)||void 0===t||t.removeChild(e.rootList)}},e.prototype.mergeOrphanNodesAfter=function(e){var t=this.items[e];if(t&&!t.isOrphanItem())for(var n=e+1;n<=this.items.length;n++)if(!t||!t.canMerge(this.items[n])){t.mergeItems(this.items.splice(e+1,n-e-1));break}},e.prototype.findListItems=function(e,t,n){if(0==this.items.length)return[];var r=new u.default(this.items[0].getNode(),0),o=new u.default(this.items[this.items.length-1].getNode(),-1),i=r.isAfter(e)?0:-1,a=this.items.length-(t.isAfter(o)?1:0);this.items.forEach((function(n,r){i=n.contains(e.node)?r:i,a=n.contains(t.node)?r:a})),i=a<this.items.length?Math.max(0,i):i,a=i>=0?Math.min(this.items.length-1,a):a;var s=i<=a?this.items.slice(i,a+1):[];return n&&(s.forEach(n),this.mergeOrphanNodesAfter(a)),s},e.prototype.populateItems=function(e,t){void 0===t&&(t=[]);for(var n=i.default(e),o=e.firstChild;o;o=o.nextSibling){var a=r(t,[n]);i.isListElement(o)?this.populateItems(o,a):3==o.nodeType&&""==o.nodeValue.trim()||this.items.push(new(h.default.bind.apply(h.default,r([void 0,o],a))))}},e}();function m(e){var t=null;f.default(e.childNodes).forEach((function(e){"LI"==a.default(e)?t=e:i.isListElement(e)?t=null:t&&!l.default(e,!0)&&t.appendChild(s.default(e)?e:v.default(e))}))}function y(e){for(;!i.isListElement(e.parentNode);){c.default(e,!0);var t=f.default(e.parentNode.childNodes).slice(1);t.length>0&&(s.default(t[0])||(t=[v.default(t)]),t.forEach((function(t){return e.appendChild(t)}))),p.default(e.parentNode)}}t.default=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(23),o=n(9),i=n(4),a=n(5);t.default=function(e){if(!e)return[];var t=e.nodeBefore,n=e.nodeAfter,s=e.rootNode,l=e.skipTags,u=e.fullSelectionEnd,d=e.fullSelectionStart,c=t?a.getNextLeafSibling(e.rootNode,t,e.skipTags):s.firstChild,f=n?a.getPreviousLeafSibling(s,n,l):s.lastChild,p=[];if(c&&f){var h=o.default(c,f),v=i.default.getStart(h).normalize(),g=i.default.getEnd(h).normalize();if(!d.isAfter(g)&&!v.isAfter(u))for(var m=d.isAfter(v)?d:v,y=u.isAfter(g)?g:u,E=o.default(m,y),b=r.default.createSelectionTraverser(s,E,l),S=null==b?void 0:b.currentBlockElement;S;S=b.getNextBlockElement())p.push(S)}return p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o=n(4);function i(e,t){if(!e||!t)return[];var n,o=e.node,i=e.offset,a=[];if(!r.default(t,o,!0))return[];if(3==o.nodeType){for(n=o.parentNode;o.previousSibling&&3==o.previousSibling.nodeType;)i+=o.previousSibling.nodeValue.length,o=o.previousSibling;a.unshift(i)}else n=o,o=o.childNodes[i];do{i=0;for(var s=!1,l=n.firstChild;l&&l!=o;l=l.nextSibling){if(3==l.nodeType){if(0==l.nodeValue.length||s)continue;s=!0}else s=!1;i++}a.unshift(i),o=n,n=n.parentNode}while(o&&o!=t);return a}t.default=function(e,t){return t?{start:i(o.default.getStart(t),e),end:i(o.default.getEnd(t),e)}:null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(42);t.default=function(e){if(r.default(e,1)){for(var t=0,n=e.currentIndex+1;n<e.snapshots.length;n++)t+=e.snapshots[n].length;e.snapshots.splice(e.currentIndex+1),e.totalSize-=t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="border-spacing,caption-side,color,cursor,direction,empty-cells,font-family,font-size,font-style,font-variant,font-weight,font,letter-spacing,line-height,list-style-image,list-style-position,list-style-type,list-style,orphans,quotes,text-align,text-indent,text-transform,visibility,white-space,widows,word-spacing".split(",");t.default=function(e){var t=e&&e.ownerDocument&&e.ownerDocument.defaultView,n=t&&t.getComputedStyle(e),o={};return r.forEach((function(e){return o[e]=n&&n.getPropertyValue(e)||""})),o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function r(e,t){var n=o(t)[0];e.body.innerHTML=n}function o(e){var t=e.indexOf("\x3c!--StartFragment--\x3e"),n=e.lastIndexOf("\x3c!--EndFragment--\x3e");if(t>=0&&n>=0&&n>=t+"\x3c!--StartFragment--\x3e".length){var r=e.substr(0,t),o=e.substr(n+"\x3c!--EndFragment--\x3e".length);return[e=e.substring(t+"\x3c!--StartFragment--\x3e".length,n),r,o]}return[e,null,null]}t.default=function(e,t,n){var o=(new DOMParser).parseFromString(e||"","text/html");return o&&o.body&&o.body.firstChild?(t&&(n||r)(o,e),o):null},t.splitWithFragment=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cloneObject=Object.assign?function(e,t){return Object.assign(t||{},e)}:function(e,t){var n=t||{};if(e)for(var r=0,o=Object.keys(e);r<o.length;r++){var i=o[r];n[i]=e[i]}return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);function o(e){var t=e.getStartNode();return e instanceof r.StartEndBlockElement&&t==e.getEndNode()&&3==t.nodeType&&["TR","TABLE"].indexOf(r.getTagOfNode(t.parentNode))>=0}t.default=function(e,t){for(var n=e.getSelectionTraverser(),r=n&&n.currentBlockElement,i=[];r;)o(r)||i.push(r),r=n.getNextBlockElement();i.forEach((function(e){var n=e.collapseToSingleElement();t(n)}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(18);t.default=function(e,t){if("string"==typeof t){var n=t.trim();r.default(e,(function(e,t){e.style.backgroundColor=t?"":n}))}else{var o=e.isDarkMode(),i=o?t.darkModeColor:t.lightModeColor;r.default(e,(function(e,n){e.style.backgroundColor=n?"":i,o&&(e.dataset.ogsb=t.lightModeColor)}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(18);t.default=function(e,t){t=t.trim(),r.default(e,(function(e,n){e.style.fontFamily=n?"":t}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(18),o=n(0);t.default=function(e,t){t=t.trim(),r.default(e,(function(e,n){e.style.fontSize=n?"":t,"normal"!=o.getComputedStyle(e,"line-height")&&(e.style.lineHeight="normal")}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(18);t.default=function(e,t){if("string"==typeof t){var n=t.trim();r.default(e,(function(e,t){e.style.color=t?"":n}))}else{var o=e.isDarkMode(),i=o?t.darkModeColor:t.lightModeColor;r.default(e,(function(e,n){e.style.color=n?"":i,o&&(e.dataset.ogsc=t.lightModeColor)}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(10);t.default=function(e){r.default(e,"bold")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(10);t.default=function(e){r.default(e,"italic")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(10);t.default=function(e){r.default(e,"underline")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(77),o=function(){function e(){var e=this;this.onExtract=function(t){return function(n){if(e.editor&&e.editor.isDarkMode()){var o=e.editor.getSelectionRange();if(o&&!o.collapsed){var i=n,a=e.editor.getSelectionRange().cloneContents(),s=e.editor.getDocument().createElement("div");s.contentEditable="true",s.appendChild(a),r.default(s),i.clipboardData.setData("text/html",s.innerHTML),i.clipboardData.setData("text/plain",s.innerText),t&&e.editor.getSelectionRange().deleteContents(),n.preventDefault()}}}}}return e.prototype.getName=function(){return"Copy"},e.prototype.initialize=function(e){this.editor=e,this.eventDisposer=e.addDomEventHandler({copy:this.onExtract(!1),cut:this.onExtract(!0)})},e.prototype.dispose=function(){this.eventDisposer(),this.eventDisposer=null,this.editor=null},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);function o(e){return e&&"undefined"!=e&&"null"!=e}t.default=function(e){var t=e.getElementsByTagName("*");r.toArray(t).forEach((function(e){var t=e;t.dataset&&(t.style.color=o(t.dataset.ogsc)?t.dataset.ogsc:"",t.style.backgroundColor=o(t.dataset.ogsb)?t.dataset.ogsb:"",o(t.dataset.ogac)?t.setAttribute("color",t.dataset.ogac):t.removeAttribute("color"),o(t.dataset.ogab)?t.setAttribute("bgcolor",t.dataset.ogab):t.removeAttribute("bgcolor"),t.dataset.ogsc&&delete t.dataset.ogsc,t.dataset.ogsb&&delete t.dataset.ogsb,t.dataset.ogac&&delete t.dataset.ogac,t.dataset.ogab&&delete t.dataset.ogab)}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=function(){function e(){var e=this;this.onPaste=function(t){r.extractClipboardEvent(t,(function(t){if(void 0===t.html){var n=e.editor.getSelectionRange(),r=e.editor.getCustomData("PasteDiv",e.createTempDivForIE,(function(e){return e.parentNode.removeChild(e)}));r.style.display="",r.focus(),e.editor.runAsync((function(){e.editor.select(n),t.html=r.innerHTML,r.style.display="none",r.innerHTML="",e.paste(t)}))}else e.paste(t)}))},this.createTempDivForIE=function(){var t=r.fromHtml('<div contenteditable style="width: 1px; height: 1px; overflow: hidden; position: fixed; top: 0; left; 0; -webkit-user-select: text"></div>',e.editor.getDocument())[0];return e.editor.insertNode(t,{position:4}),t}}return e.prototype.getName=function(){return"CorePaste"},e.prototype.initialize=function(e){this.editor=e,this.disposer=this.editor.addDomEventHandler("paste",this.onPaste)},e.prototype.dispose=function(){this.disposer(),this.disposer=null,this.editor=null},e.prototype.paste=function(e){var t=this,n={types:e.types,image:e.image,text:e.text,rawHtml:e.html,snapshotBeforePaste:null,imageDataUri:null,html:null,originalFormat:null};if(n.image){var r=new FileReader;r.onload=function(){n.imageDataUri=r.result,t.editor.paste(n)},r.onerror=function(){n.image=null,t.editor.paste(n)},r.readAsDataURL(n.image)}else this.editor.paste(n)},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=function(){function e(e){var t=this;this.disableRestoreSelectionOnFocus=e,this.inIme=!1,this.onNativeEvent=function(e){t.editor.runAsync((function(){t.editor.addUndoSnapshot((function(){}),"cut"==e.type?"Cut":"Drop")}))},this.onFocus=function(){if(t.disableRestoreSelectionOnFocus){if(t.cachedPosition&&t.cachedFormatState){var e=t.editor.getSelectionRange();e.collapsed&&r.Position.getStart(e).normalize().equalTo(t.cachedPosition)?t.restorePendingFormatState():t.clear()}}else t.editor.restoreSavedRange()},this.onBlur=function(){t.editor.saveSelectionRange()},this.onScroll=function(e){t.editor.triggerPluginEvent(15,{rawEvent:e,scrollContainer:t.editor.getScrollContainer()})}}return e.prototype.getName=function(){return"DOMEvent"},e.prototype.initialize=function(e){var t,n=this;this.editor=e,this.disposer=e.addDomEventHandler(((t={compositionstart:function(){return n.inIme=!0},compositionend:function(t){n.inIme=!1,e.triggerPluginEvent(3,{rawEvent:t})},drop:this.onNativeEvent,cut:this.onNativeEvent,focus:this.onFocus})[r.Browser.isIEOrEdge?"beforedeactivate":"blur"]=this.onBlur,t)),this.editor.getScrollContainer().addEventListener("scroll",this.onScroll)},e.prototype.dispose=function(){this.editor.getScrollContainer().removeEventListener("scroll",this.onScroll),this.disposer(),this.disposer=null,this.editor=null,this.clear()},e.prototype.onPluginEvent=function(e){switch(e.eventType){case 13:this.cachedPosition=this.getCurrentPosition(),this.cachedFormatState=e.formatState;break;case 0:case 4:case 6:this.cachedPosition&&!this.cachedPosition.equalTo(this.getCurrentPosition())&&this.clear()}},e.prototype.restorePendingFormatState=function(){var e=this;if(this.cachedFormatState){var t=r.getPendableFormatState(this.editor.getDocument());Object.keys(r.PendableFormatCommandMap).forEach((function(n){e.cachedFormatState[n]!=t[n]&&e.editor.getDocument().execCommand(r.PendableFormatCommandMap[n],!1,null)})),this.cachedPosition=this.getCurrentPosition()}},e.prototype.isInIME=function(){return this.inIme},e.prototype.clear=function(){this.cachedPosition=null,this.cachedFormatState=null},e.prototype.getCurrentPosition=function(){var e=this.editor.getSelectionRange();return e&&r.Position.getStart(e).normalize()},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(43),o=function(){function e(){this.featureMap={},this.autoCompleteSnapshot=null,this.autoCompleteChangeSource=null}return e.prototype.getName=function(){return"Edit"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.addFeature({keys:[8],shouldHandleEvent:function(){return null!==t.autoCompleteSnapshot},handleEvent:function(e,n){e.rawEvent.preventDefault(),n.setContent(t.autoCompleteSnapshot,!1)}})},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){var t=!1,n=this.findFeature(e);switch(e.eventType){case 6:t=this.autoCompleteChangeSource!=e.source;break;case 4:case 0:t=!0}n&&n.handleEvent(e,this.editor),t&&(this.autoCompleteSnapshot=null,this.autoCompleteChangeSource=null)},e.prototype.addFeature=function(e){var t=this;e.keys.forEach((function(n){var r=t.featureMap[n]||[];r.push(e),t.featureMap[n]=r}))},e.prototype.performAutoComplete=function(e,t){var n=this;this.editor.addUndoSnapshot((function(r,o,i){var a=e();return n.autoCompleteSnapshot=i,n.autoCompleteChangeSource=t,a}),t)},e.prototype.findFeature=function(e){var t,n=this,o=!1,i=!1;if(0==e.eventType){var a=e.rawEvent;i=r.default(a),o=i||a.altKey,t=this.featureMap[a.which]}else 6==e.eventType&&(t=this.featureMap[2048]);return t&&t.filter((function(t){return(t.allowFunctionKeys||!o)&&t.shouldHandleEvent(e,n.editor,i)}))[0]},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(82),i=function(){function e(){}return e.prototype.getName=function(){return"FirefoxTypeAfterLink"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){if(r.Browser.isFirefox&&1==e.eventType||9==e.eventType){var t=this.editor.getSelectionRange();if(t&&t.collapsed&&this.editor.getElementAtCursor("A[href]")){var n=o.cacheGetContentSearcher(e,this.editor).getInlineElementBefore();n instanceof r.LinkInlineElement&&this.editor.select(new r.Position(n.getContainerNode(),-3))}}},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(44),o=n(83);t.cacheGetContentSearcher=function(e,t){return r.default(e,"CONTENTSEARCHER",(function(){return t.getContentSearcherOfCursor()}))},t.clearContentSearcherCache=function(e){o.default(e,"CONTENTSEARCHER")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){e&&e.eventDataCache&&e.eventDataCache.hasOwnProperty(t)&&delete e.eventDataCache[t]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){var e=this;this.onMouseUp=function(t){e.editor&&(e.removeMouseUpEventListener(),e.editor.triggerPluginEvent(5,{rawEvent:t}))}}return e.prototype.getName=function(){return"MouseUp"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.removeMouseUpEventListener(),this.editor=null},e.prototype.onPluginEvent=function(e){4!=e.eventType||this.mouseUpEventListerAdded||(this.editor.getDocument().addEventListener("mouseup",this.onMouseUp,!0),this.mouseUpEventListerAdded=!0)},e.prototype.removeMouseUpEventListener=function(){this.mouseUpEventListerAdded&&(this.mouseUpEventListerAdded=!1,this.editor.getDocument().removeEventListener("mouseup",this.onMouseUp,!0))},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=function(){function e(){}return e.prototype.getName=function(){return"TypeInContainer"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){1==e.eventType&&this.onKeyPress(e)},e.prototype.ensureTypeInElement=function(e,t){var n,o=e.normalize(),i=this.editor.getBlockElementAtNode(o.node);if(i){n=i.collapseToSingleElement();var a=r.isNodeEmpty(n)||t&&this.wasNodeJustCreatedByKeyboardEvent(t,n);n=n&&a?n:null}else n=r.fromHtml(r.Browser.isEdge?"<div><span><br></span></div>":"<div><br></div>",this.editor.getDocument())[0],this.editor.insertNode(n,{position:1,updateCursor:!1,replaceSelection:!1,insertOnNewLine:!1}),o=new r.Position(n.firstChild,0);return n&&r.applyFormat(n,this.editor.getDefaultFormat(),this.editor.isDarkMode()),o},e.prototype.onKeyPress=function(e){var t=this,n=this.editor.getSelectionRange();n&&!this.editor.contains(r.findClosestElementAncestor(n.startContainer))&&(n.collapsed?this.tryNormalizeTyping(e,n):n.collapsed||this.editor.runAsync((function(){t.tryNormalizeTyping(e)})))},e.prototype.tryNormalizeTyping=function(e,t){var n=this.ensureTypeInElement(r.Position.getStart(t||this.editor.getSelectionRange()),e);this.editor.select(n)},e.prototype.wasNodeJustCreatedByKeyboardEvent=function(e,t){return r.isNode(e.rawEvent.target)&&e.rawEvent.target.contains(t)&&e.rawEvent.key===t.innerText},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(43),o=n(142),i=function(){function e(e,t){void 0===t&&(t=1e7),this.preserveSnapshots=e,this.maxBufferSize=t}return e.prototype.getName=function(){return"Undo"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null,this.preserveSnapshots||this.clear()},e.prototype.onPluginEvent=function(e){if(!this.editor.isInIME())switch(e.eventType){case 10:this.preserveSnapshots&&(this.canUndo()||this.canRedo())||this.addUndoSnapshot();break;case 0:this.onKeyDown(e.rawEvent);break;case 1:this.onKeyPress(e.rawEvent);break;case 3:this.clearRedoForInput(),this.addUndoSnapshot();break;case 6:this.isRestoring||this.clearRedoForInput()}},e.prototype.clear=function(){this.undoSnapshots=null,this.hasNewContent=!1},e.prototype.undo=function(){this.hasNewContent&&this.addUndoSnapshot(),this.restoreSnapshot(-1)},e.prototype.redo=function(){this.restoreSnapshot(1)},e.prototype.canUndo=function(){return this.hasNewContent||this.getSnapshotsManager().canMove(-1)},e.prototype.canRedo=function(){return this.getSnapshotsManager().canMove(1)},e.prototype.addUndoSnapshot=function(){var e=this.editor.getContent(!1,!0);return this.getSnapshotsManager().addSnapshot(e),this.hasNewContent=!1,e},e.prototype.getSnapshotsManager=function(){return this.undoSnapshots||(this.undoSnapshots=new o.default(this.maxBufferSize)),this.undoSnapshots},e.prototype.restoreSnapshot=function(e){var t=this.getSnapshotsManager().move(e);if(null!=t)try{this.isRestoring=!0,this.editor.setContent(t)}finally{this.isRestoring=!1}},e.prototype.onKeyDown=function(e){if(8==e.which||46==e.which){var t=this.editor.getSelectionRange();!t||t.collapsed&&this.lastKeyPress==e.which&&!r.default(e)||this.addUndoSnapshot(),this.hasNewContent=!0,this.lastKeyPress=e.which}else e.which>=33&&e.which<=40&&(this.hasNewContent&&this.addUndoSnapshot(),this.lastKeyPress=0)},e.prototype.onKeyPress=function(e){if(!e.metaKey){var t=this.editor.getSelectionRange();t&&!t.collapsed||32==e.which&&32!=this.lastKeyPress||13==e.which?(this.addUndoSnapshot(),13==e.which&&(this.hasNewContent=!0)):this.clearRedoForInput(),this.lastKeyPress=e.which}},e.prototype.clearRedoForInput=function(){this.getSnapshotsManager().clearRedo(),this.lastKeyPress=0,this.hasNewContent=!0},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(88);t.default=function(e){return!r.default(e)&&e.key&&1==e.key.length}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e){var t=e.ctrlKey||"Control"===e.key,n=e.altKey||"Alt"===e.key,r=e.metaKey||"Meta"===e.key;return t||n||r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o={darkModeColor:"rgb(51,51,51)",lightModeColor:"rgb(255,255,255)"},i={darkModeColor:"rgb(255,255,255)",lightModeColor:"rgb(0,0,0)"};t.calculateDefaultFormat=function(e,t,n){if(n&&(t.backgroundColors||(t.backgroundColors=o),t.textColors||(t.textColors=i)),t&&0===Object.keys(t).length)return{};var a=(t=t||{}).fontFamily,s=t.fontSize,l=t.textColor,u=t.textColors,d=t.backgroundColor,c=t.backgroundColors,f=t.bold,p=t.italic,h=t.underline,v=a&&s&&(l||u)?null:r.getComputedStyles(e);return{fontFamily:a||v[0],fontSize:s||v[1],get textColor(){return u?n?u.darkModeColor:u.lightModeColor:l||v[2]},textColors:u,get backgroundColor(){return c?n?c.darkModeColor:c.lightModeColor:d||""},backgroundColors:c,bold:f,italic:p,underline:h}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.hasFocus=function(e){var t=e.document.activeElement;return t&&r.contains(e.contentDiv,t,!0)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){e.focus(),e.addUndoSnapshot((function(n,r){e.getSelectedRegions().forEach((function(e){return t(e,n,r)})),e.select(n,r)}),"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(91),o=n(0);t.default=function(e,t){r.default(e,(function(e,n,r){var i=o.createVListFromRegion(e,!0);i&&(i.changeListType(n,r,t),i.writeBack())}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o="LI,THEAD,TBODY,TR,TD,TH".split(","),i=function(e){};t.default=function(e,t,n,a,s){void 0===a&&(a=function(e){return r.wrap(e,t)}),void 0===s&&(s=r.unwrap),e.focus(),e.addUndoSnapshot((function(l,u){var d,c=e.getSelectionRange();if(c&&0==e.queryElements(t,1,s).length){var f=r.Position.getStart(c).normalize().node,p=e.getBlockElementAtNode(f),h=r.Position.getEnd(c).normalize().node,v=e.getBlockElementAtNode(h),g=p&&v?e.collapseNodes(p.getStartNode(),v.getEndNode(),!0):[];if(0==g.length)g=r.fromHtml("<DIV>"+(r.Browser.isIEOrEdge?"&#8203;":"<BR>")+"</DIV>",e.getDocument()),e.insertNode(g[0]),e.select(g[0],0);else if(1==g.length){var m=r.getTagOfNode(g[0]);"BR"==m?g=[r.wrap(g[0])]:"LI"!=m&&"TD"!=m||(g=r.toArray(g[0].childNodes))}else for(;g[0]&&e.contains(g[0].parentNode)&&g.some((function(e){return o.indexOf(r.getTagOfNode(e))>=0}));)g=[r.splitBalancedNodeRange(g)];d=a(g),(n||i)(d)}return!e.select(l,u)&&d&&e.select(d),d}),"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function r(e,t){var n=t.getAttribute("NodeId");return n||(n=e.nextNodeId.toString(),e.nextNodeId++,t.setAttribute("NodeId",n)),n}t.createCustomData=function(){return{dict:{},nextNodeId:1}},t.setObject=function(e,t,n,o){if(1==t.nodeType){var i=r(e,t);""!=i&&(e.dict[i]||(e.dict[i]={}),e.dict[i][n]=o)}},t.getObject=function(e,t,n){if(1==t.nodeType){var o=r(e,t);if(""!=o)return e.dict[o]&&e.dict[o][n]}return null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createLevelLists=function(){return{listsMetadata:{},currentUniqueListId:-1}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WORD_ORDERED_LIST_SELECTOR='div.ListContainerWrapper > ul[class^="BulletListStyle"]',t.WORD_UNORDERED_LIST_SELECTOR='div.ListContainerWrapper > ol[class^="NumberListStyle"]',t.WORD_ONLINE_IDENTIFYING_SELECTOR=t.WORD_ORDERED_LIST_SELECTOR+","+t.WORD_UNORDERED_LIST_SELECTOR,t.LIST_CONTAINER_ELEMENT_CLASS_NAME="ListContainerWrapper",t.UNORDERED_LIST_TAG_NAME="UL",t.ORDERED_LIST_TAG_NAME="OL";t.WAC_IDENTIFING_SELECTOR='ul[class^="BulletListStyle"]>.OutlineElement,ol[class^="NumberListStyle"]>.OutlineElement'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(20),o=n(19);t.default=function(e,t,n){var i=o.getEntitySelector(t,n);return e.queryElements(i).map((function(e){return r.default(e)})).filter((function(e){return!!e}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(20);t.default=function(e,t,n,o){var i=t&&r.default(t);i&&(0==n&&i.isReadonly&&(t.contentEditable="false"),e.triggerPluginEvent(16,{operation:n,rawEvent:o,entity:i}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(19),o=n(0);t.default=function(e,t,n,i,a){var s=o.wrap(n,i?"DIV":"SPAN");return s.className=r.serializeEntityInfo(e,t,a),!i&&a&&(s.style.display="inline-block"),s}},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0});var o=n(101);t.createEditor=o.default,r(n(215)),r(n(0)),r(n(2)),r(n(17)),r(n(46))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(46),o=n(2);t.default=function(e,t,n){var i=[new r.HyperLink,new r.Paste,new r.ContentEdit];t&&(i=i.concat(t));var a={plugins:i,initialContent:n,defaultFormat:{fontFamily:"Calibri,Arial,Helvetica,sans-serif",fontSize:"11pt",textColor:"#000000"}};return new o.Editor(e,a)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(103))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(104);t.ContentEdit=r.default;var o=n(47);t.getDefaultContentEditFeatures=o.getDefaultContentEditFeatures},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(47),o=n(133),i=n(175),a=n(176),s=n(177),l=n(178),u=n(179),d=n(180),c=n(181),f=function(){function e(e){this.featureSet=e}return e.prototype.getName=function(){return"ContentEdit"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.getFilteredFeatures().forEach((function(e){return t.editor.addContentEditFeature(e)}))},e.prototype.dispose=function(){this.editor=null},e.prototype.getFilteredFeatures=function(){var e=this.featureSet||r.getDefaultContentEditFeatures(),t={indentWhenTab:d.IndentWhenTab,outdentWhenShiftTab:d.OutdentWhenShiftTab,outdentWhenBackspaceOnEmptyFirstLine:d.OutdentWhenBackOn1stEmptyLine,outdentWhenEnterOnEmptyLine:d.OutdentWhenEnterOnEmptyLine,mergeInNewLineWhenBackspaceOnFirstChar:d.MergeInNewLine,unquoteWhenBackspaceOnEmptyFirstLine:c.UnquoteWhenBackOnEmpty1stLine,unquoteWhenEnterOnEmptyLine:c.UnquoteWhenEnterOnEmptyLine,tabInTable:l.TabInTable,upDownInTable:l.UpDownInTable,insertLineBeforeStructuredNodeFeature:a.InsertLineBeforeStructuredNodeFeature,autoBullet:d.AutoBullet,autoLink:o.AutoLink,unlinkWhenBackspaceAfterLink:o.UnlinkWhenBackspaceAfterLink,defaultShortcut:i.DefaultShortcut,noCycleCursorMove:s.NoCycleCursorMove,smartOrderedList:d.getSmartOrderedList(e.smartOrderedListStyles),markdownBold:u.MarkdownBold,markdownItalic:u.MarkdownItalic,markdownStrikethru:u.MarkdownStrikethru,markdownInlineCode:u.MarkdownInlineCode};return Object.keys(t).filter((function(t){return e[t]})).map((function(e){return t[e]}))},e}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o=n(7),i=n(14),a=n(50),s=n(53),l=function(){function e(e,t){this.rootNode=e,this.startNode=r.default(e,t)?t:null}return e.prototype.getStartBlockElement=function(){return this.startNode?o.default(this.rootNode,this.startNode):a.getFirstBlockElement(this.rootNode)},e.prototype.getStartInlineElement=function(){return this.startNode?i.default(this.rootNode,this.startNode):s.getFirstInlineElement(this.rootNode)},e.prototype.isBlockInScope=function(e){return r.default(this.rootNode,e.getStartNode())},e.prototype.trimInlineElement=function(e){return e},e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(55),o=n(7),i=n(14),a=n(33),s=n(32),l=n(4),u=n(38),d=n(53),c=function(){function e(e,t,n){this.rootNode=e,this.startFrom=n,t=a.default(t)?l.default.getStart(t):t,this.position=t.normalize(),this.block=o.default(this.rootNode,this.position.node)}return e.prototype.getStartBlockElement=function(){return this.block},e.prototype.getStartInlineElement=function(){if(this.block)switch(this.startFrom){case 0:case 1:case 2:return function(e,t){if(e instanceof s.default){var n=e.getStartNode();return t?d.getFirstInlineElement(n):d.getLastInlineElement(n)}return i.default(e,t?e.getStartNode():e.getEndNode())}(this.block,0==this.startFrom);case 3:var e=u.getInlineElementAfter(this.rootNode,this.position);return e&&this.block.contains(e.getContainerNode())?e:new r.default(this.position,this.block)}return null},e.prototype.isBlockInScope=function(e){return!(!this.block||!e)&&this.block.equals(e)},e.prototype.trimInlineElement=function(e){return this.block&&e&&this.block.contains(e.getContainerNode())?e:null},e}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7),o=n(27),i=n(4),a=n(38),s=function(){function e(e,t){this.rootNode=e,this.start=i.default.getStart(t).normalize(),this.end=i.default.getEnd(t).normalize()}return e.prototype.getStartBlockElement=function(){return this.startBlock||(this.startBlock=r.default(this.rootNode,this.start.node)),this.startBlock},e.prototype.getStartInlineElement=function(){return this.startInline||(this.startInline=this.trimInlineElement(a.getInlineElementAfter(this.rootNode,this.start))),this.startInline},e.prototype.isBlockInScope=function(e){if(!e)return!1;var t=!1,n=this.getStartBlockElement();if(this.start.equalTo(this.end))t=n&&n.equals(e);else{var o=r.default(this.rootNode,this.end.node);t=n&&o&&(e.equals(n)||e.equals(o)||e.isAfter(n)&&o.isAfter(e))}return t},e.prototype.trimInlineElement=function(e){if(!e||this.start.equalTo(this.end))return null;var t=e.getStartPosition(),n=e.getEndPosition();if(t.isAfter(this.end)||this.start.isAfter(n))return null;var r=!1,i=!1;return this.start.isAfter(t)&&(t=this.start,r=!0),n.isAfter(this.end)&&(n=this.end,i=!0),t.isAfter(n)||t.equalTo(n)?null:r||i?new o.default(e,r&&t,i&&n):e},e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(23),o=n(9),i=/[\s\u00A0\u200B\u3000]+([^\s\u00A0\u200B\u3000]*)$/i,a=function(){function e(e,t){this.rootNode=e,this.position=t,this.text="",this.inlineElements=[]}return e.prototype.getWordBefore=function(){var e=this;return this.word||this.traverse((function(){return e.word})),this.word},e.prototype.getInlineElementBefore=function(){return this.inlineBefore||this.traverse(null),this.inlineBefore},e.prototype.getInlineElementAfter=function(){return this.inlineAfter||(this.inlineAfter=r.default.createBlockTraverser(this.rootNode,this.position).currentInlineElement),this.inlineAfter},e.prototype.getSubStringBefore=function(e){var t=this;return this.text.length<e&&this.traverse((function(){return t.text.length>=e})),this.text.substr(Math.max(0,this.text.length-e))},e.prototype.getRangeFromText=function(e,t){if(!e)return null;var n,r,i=e.length-1;return this.forEachTextInlineElement((function(o){for(var a=o.getTextContent()||"",s=a.length-1;s>=0&&i>=0;s--)if(e.charCodeAt(i)==a.charCodeAt(s))i--,r||(r=o.getStartPosition().move(s+1));else if(t||r)return!0;return-1==i&&(n=o.getStartPosition().move(s+1),!0)})),n&&r&&o.default(n,r)},e.prototype.forEachTextInlineElement=function(e){this.inlineElements.some(e)||this.traverse(e)},e.prototype.getNearestNonTextInlineElement=function(){var e=this;return this.nearestNonTextInlineElement||this.traverse((function(){return e.nearestNonTextInlineElement})),this.nearestNonTextInlineElement},e.prototype.traverse=function(e){if(this.traverser=this.traverser||r.default.createBlockTraverser(this.rootNode,this.position),this.traverser&&!this.traversingComplete)for(var t=this.traverser.getPreviousInlineElement();!this.traversingComplete;){if(this.inlineBefore=this.inlineBefore||t,!t||!t.isTextualInlineElement()){this.nearestNonTextInlineElement=t,this.traversingComplete=!0,this.word||(this.word=this.text);break}var n=t.getTextContent();if(!this.word){var o=i.exec(n);o&&2==o.length&&(this.word=o[1]+this.text)}if(this.text=n+this.text,this.inlineElements.push(t),e&&e(t))break;t=this.traverser.getPreviousInlineElement()}},e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(t){var r=e.style,o=t.fontFamily,i=t.fontSize,a=t.textColor,s=t.textColors,l=t.backgroundColor,u=t.backgroundColors,d=t.bold,c=t.italic,f=t.underline;o&&(r.fontFamily=o),i&&(r.fontSize=i),(a||s)&&(s&&n&&(e.dataset.ogsc=s.lightModeColor),r.color=a),(l||u)&&(u&&n&&(e.dataset.ogsb=u.lightModeColor),r.backgroundColor=l),d&&(r.fontWeight="bold"),c&&(r.fontStyle="italic"),f&&(r.textDecoration="underline")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8),o=n(56),i=/^Version:[0-9\.]+\s+StartHTML:\s*([0-9]+)\s+EndHTML:\s*([0-9]+)\s+/i;function a(e){for(var t=e.items?e.items.length:0,n=0;n<t;n++){var r=e.items[n];if(r.type&&0==r.type.indexOf("image/"))return r.getAsFile()}t=e.files?e.files.length:0;for(n=0;n<t;n++){var o=e.files.item(n);if(o.type&&0==o.type.indexOf("image/"))return o}return null}function s(e){var t=i.exec(e);if(t&&3==t.length){var n=parseInt(t[1]),r=parseInt(t[2]);n>0&&r>n&&(e=e.substring(n,r))}return e}t.default=function(e,t){var n=e.clipboardData||e.target.ownerDocument.defaultView.clipboardData,i={types:n.types?r.default(n.types):[],text:n.getData("text"),image:a(n),html:void 0};if(e.clipboardData&&e.clipboardData.items){e.preventDefault();for(var l=e.clipboardData.items,u=0;u<l.length;u++){var d=l[u];if(d.type&&0==d.type.indexOf("text/html"))return void d.getAsString((function(e){i.html=o.Browser.isEdge?s(e):e,t(i)}))}i.html=null}t(i)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PendableFormatCommandMap={isBold:"bold",isItalic:"italic",isUnderline:"underline",isStrikeThrough:"strikeThrough",isSubscript:"subscript",isSuperscript:"superscript"},t.default=function(e){return Object.keys(t.PendableFormatCommandMap).reduce((function(n,r){return n[r]=e.queryCommandState(t.PendableFormatCommandMap[r]),n}),{})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(26);t.default=function(e){return"rtl"==r.getComputedStyle(e,"direction")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=/^[^?]+%[^0-9a-f]+|^[^?]+%[0-9a-f][^0-9a-f]+|^[^?]+%00|^[^?]+%$|^https?:\/\/[^?\/]+@|^www\.[^?\/]+@/i,o="(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)*[a-z0-9](?:[a-z0-9-]*[a-z0-9])?(?:\\:[0-9]+)?(?:[\\/\\?]\\S*)?",i={http:{match:new RegExp("^(?:microsoft-edge:)?http:\\/\\/"+o+"|www\\."+o,"i"),except:r,normalizeUrl:function(e){return new RegExp("^(?:microsoft-edge:)?http:\\/\\/","i").test(e)?e:"http://"+e}},https:{match:new RegExp("^(?:microsoft-edge:)?https:\\/\\/"+o,"i"),except:r},mailto:{match:new RegExp("^mailto:\\S+@\\S+\\.\\S+","i")},notes:{match:new RegExp("^notes:\\/\\/\\S+","i")},file:{match:new RegExp("^file:\\/\\/\\/?\\S+","i")},unc:{match:new RegExp("^\\\\\\\\\\S+","i")},ftp:{match:new RegExp("^ftp:\\/\\/"+o+"|ftp\\."+o,"i"),normalizeUrl:function(e){return new RegExp("^ftp:\\/\\/","i").test(e)?e:"ftp://"+e}},news:{match:new RegExp("^news:(\\/\\/)?"+o,"i")},telnet:{match:new RegExp("^telnet:(\\/\\/)?"+o,"i")},gopher:{match:new RegExp("^gopher:\\/\\/"+o,"i")},wais:{match:new RegExp("^wais:(\\/\\/)?"+o,"i")}};t.default=function(e){if(e)for(var t=0,n=Object.keys(i);t<n.length;t++){var r=n[t],o=i[r],a=e.match(o.match);if(a&&a[0]==e&&(!o.except||!o.except.test(e)))return{scheme:r,originalUrl:e,normalizedUrl:o.normalizeUrl?o.normalizeUrl(e):e}}return null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(39),o=n(3),i=n(9),a=n(12),s=n(7),l=n(1),u=n(28),d=n(57),c=n(34),f=n(4),p=n(29),h=n(37),v=n(8),g=n(30),m=n(58),y=n(13),E=n(11),b=[function(e,t,n){var r=s.default(e,n.node);if(r){var a=p.default(e,"a[href]",null,1,i.default(n)).filter((function(e){return r.contains(e)}))[0];if(a&&u.default(a)&&(n=new f.default(a,-2),S(a),a=null),a&&t.querySelector&&t.querySelector("a[href]")){var l=n.normalize(),d=l.node.parentNode,c=3==l.node.nodeType?h.default(l.node,l.offset,!1):l.isAtEnd?l.node.nextSibling:l.node,v=e.ownerDocument.createTextNode("");for(d.insertBefore(v,c);o.default(a,v);)v=E.splitBalancedNodeRange(v);n=new f.default(v,-2),S(v)}}return n},function(e,t,n){var r=t;if(11==r.nodeType){var o=v.default(r.childNodes).filter((function(e){return"BR"!=l.default(e)}));r=1==o.length?o[0]:null}var i=l.default(r),s=i&&"BR"==l.default(r.nextSibling),u=a.default(n.node,e,"LI"),c=u&&a.default(u,e,"OL,UL"),p=a.default(n.node,e,"TD,TH"),h=p&&a.default(p,e,"TR");"LI"==i&&(i=c?l.default(c):"UL",r=y.default(r,i));if("OL"!=i&&"UL"!=i||"LI"!=l.default(r.firstChild)){if("TABLE"==i&&h){var E=new m.default(r),b=new m.default(p);0==b.col&&p==b.getCell(b.row,0).td&&E.cells[0]&&E.cells[0].length==b.cells[0].length&&d.default(n,p)&&("TBODY"!=l.default(r.firstChild)||r.firstChild.nextSibling||g.default(r.firstChild),g.default(r),n=new f.default(h,-3))}}else{var C=!r.firstChild.nextSibling&&!s;s&&r.parentNode&&S(r.nextSibling),C?(g.default(r.firstChild),g.default(r)):l.default(c)==i&&(g.default(r),n=new f.default(u,d.default(n,u)?-2:-3))}return n},function(e,t,n){if("P"==l.default(n.node)){var o=n.normalize(),i=r.default(n.node,"div");o.node!=i&&(n=o)}return n},function(e,t,n){c.default(n.node)&&(n=new f.default(n.node,n.isAtEnd?-3:-2));return n}];function S(e){e&&e.parentNode&&e.parentNode.removeChild(e)}t.default=function(e,t,n){return b.forEach((function(r){n=r(e,t,n)})),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(23);t.default=function(e){for(var t=r.default.createBodyTraverser(e),n=t&&t.currentBlockElement,o=[];n;)o.push(n.getTextContent()),n=t.getNextBlockElement();return o.join("\n")}},function(e,t,n){"use strict";var r=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r};Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),i=n(40),a=n(1),s=n(16),l=n(8),u=n(30),d=n(13),c=[null,"lower-alpha","lower-roman"],f=function(){function e(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(this.node=e,!e)throw new Error("node must not be null");this.listTypes=r([0],t)}return e.prototype.getListType=function(){return this.listTypes[this.listTypes.length-1]},e.prototype.getNode=function(){return this.node},e.prototype.contains=function(e){return o.default(this.node,e,!0)},e.prototype.isOrphanItem=function(){return"LI"!=a.default(this.node)},e.prototype.canMerge=function(e){return!(!(null==e?void 0:e.isOrphanItem())||this.listTypes.length!=e.listTypes.length)&&this.listTypes.every((function(t,n){return e.listTypes[n]==t}))},e.prototype.mergeItems=function(e){var t=this;p((null==e?void 0:e.map((function(e){return e.node})))||[],!0,!1).forEach((function(e){return t.node.appendChild(e)}))},e.prototype.indent=function(){var e=this.getListType();0!=e&&this.listTypes.push(e)},e.prototype.outdent=function(){this.listTypes.length>1&&this.listTypes.pop()},e.prototype.changeListType=function(e){0==e?this.listTypes=[e]:(this.outdent(),this.listTypes.push(e))},e.prototype.writeBack=function(e){for(var t,n,r=this.node.ownerDocument,o=1;o<e.length;o++)if(i.default(e[o])!==this.listTypes[o]){e.splice(o);break}for(;o<this.listTypes.length;o++){var s=this.listTypes[o],d=r.createElement(1==s?"ol":"ul");1==s&&(d.style.listStyleType=c[(o-1)%c.length]),e[e.length-1].appendChild(d),e.push(d)}e[e.length-1].appendChild(this.node),this.listTypes.length<=1&&p("LI"==a.default(this.node)?(t=this.node,n=l.default(t.childNodes),u.default(t),n):[this.node],!0,!0)},e}();function p(e,t,n){return!(e.length>0)||t&&s.default(e[0])||n&&s.default(e[e.length])||(e=[d.default(e)]),e}t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(12),o=n(62),i=n(41),a=n(25),s=n(61),l=n(5),u=n(40);function d(e,t,n){var r=t[n?t.length-1:0];r=c(e,r=l.getLeafSibling(e.rootNode,r,n,e.skipTags,!0)),i.default(e,r)&&u.isListElement(r)&&(n?t.push(r):t.unshift(r))}function c(e,t){var n=r.default(t,e.rootNode,"ol,ul");if(n)for(var o=void 0;o=r.default(n.parentNode,e.rootNode,"ol,ul");)n=o;return n}t.default=function(e,t,n){if(!e)return null;var r=[];if(n){var i=c(e,n);i&&r.push(i)}else{o.default(e).forEach((function(t){var n=c(e,t.getStartNode());n?r[r.length-1]!=n&&r.push(n):r.push(t.collapseToSingleElement())})),t&&(d(e,r,!1),d(e,r,!0)),r=r.filter((function(e){return!a.default(e,!0)}))}var l=null;if(r.length>0){var f=r.shift();l=u.isListElement(f)?new s.default(f):function(e){var t,n=e.ownerDocument.createElement("ol");null===(t=e.parentNode)||void 0===t||t.insertBefore(n,e);var r=new s.default(n);return r.appendItem(e,0),r}(f),r.forEach((function(e){u.isListElement(e)?l.mergeVList(new s.default(e)):l.appendItem(e,0)}))}return l}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o=n(12),i=n(4),a=n(29),s=n(119),l=n(5);function u(e,t){var n=i.default.getStart(e).normalize(),o=i.default.getEnd(e).normalize();return function(e,i,a){return function(e,t,n,o){if(e&&e.firstChild){var i=t&&l.getNextLeafSibling(e,t,o),a=n&&l.getPreviousLeafSibling(e,n,o),s=!t||r.default(e,t)&&r.default(e,i),u=!n||r.default(e,n)&&r.default(e,a),d=!(t&&n&&(r.default(t,n,!0)||r.default(t,a,!0)||r.default(n,t,!0)||r.default(n,i,!0)));return s&&u&&d}return!1}(e,i,a,t)?{rootNode:e,nodeBefore:i,nodeAfter:a,skipTags:t,fullSelectionStart:n,fullSelectionEnd:o}:null}}t.default=function(e,t,n){var i=[];if(e&&t){var l=s.default[n],d=l.innerSelector,c=l.skipTags,f=function(e,t,n){var i=[{innerNode:e,children:[]}],l=s.default[n],u=l.outerSelector,d=l.innerSelector,c=a.default(e,u,null,2,t);return a.default(e,d,(function(t){var n=o.default(t,e,u);if(n&&c.indexOf(n)<0){for(var a={innerNode:t,children:[]},s=i.length-1;s>=0;s--){var l=i[s],d=l.innerNode,f=l.children;if(r.default(d,n)){var p=f.filter((function(e){return e.outerNode==n}))[0];p||(p={outerNode:n,boundaries:[]},f.push(p)),p.boundaries.push(a);break}}i.push(a)}}),1,t),i[0]}(e,t,n),p=o.default(t.startContainer,e,d)||e,h=o.default(t.endContainer,e,d)||e;i=function e(t,n,r,o,i){var a;i=i||n.innerNode==r;var s=!1,l=n.children,u=n.innerNode,d=[];if(0==l.length)d.push(t(u));else for(var c=0;c<=l.length&&!s;c++){var f=l[c]||{},p=f.outerNode,h=f.boundaries,v=null===(a=l[c-1])||void 0===a?void 0:a.outerNode;i&&d.push(t(u,v,p)),null==h||h.forEach((function(n){var a,l;l=(a=e(t,n,r,o,i))[0],i=a[1],s=a[2],d=d.concat(l)}))}return[d,i,s||u==o]}(u(t,c),f,p,h)[0]}return i.filter((function(e){return!!e}))},t.getRegionCreator=u},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0});var o=((r={})[0]={skipTags:["TABLE"],outerSelector:"table",innerSelector:"td,th"},r);t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(21),o=n(41);t.default=function(e,t){if(!(t=t&&t.filter((function(t){return o.default(e,t)})))||0==t.length)return[];var n=t[0],i=t[t.length-1];return o.default(e,n)&&o.default(e,i)?r.default(e.rootNode,n,i,!0):[]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9);function o(e){var t=e||{},n=t.left,r=t.right,o=t.top,i=t.bottom;return n+r+o+i>0?{left:Math.round(n),right:Math.round(r),top:Math.round(o),bottom:Math.round(i)}:null}t.default=function(e){if(!e)return null;var t=r.default(e),n=t.getBoundingClientRect&&o(t.getBoundingClientRect());if(n)return n;e=e.normalize();var i=t.getClientRects&&t.getClientRects();if(n=i&&1==i.length&&o(i[0]))return n;if(3==e.node.nodeType){var a=e.node.ownerDocument.createElement("SPAN");if(a.innerHTML="​",(t=r.default(e)).insertNode(a),n=a.getBoundingClientRect&&o(a.getBoundingClientRect()),a.parentNode.removeChild(a),n)return n}var s=e.element;return s&&s.getBoundingClientRect&&(n=o(s.getBoundingClientRect()))?n:null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(63);t.default=function(e,t){if(!e)return"";var n=e.innerHTML,o=t&&r.default(e,t);return o?n+"\x3c!--"+JSON.stringify(o)+"--\x3e":n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9);t.default=function(e,t){e.innerHTML=t||"";var n=null,o=e.lastChild;try{(n=o&&8==o.nodeType&&JSON.parse(o.nodeValue))&&n.end&&n.end.length>0&&n.start&&n.start.length>0?e.removeChild(o):n=null}catch(e){}return n&&r.default(e,n.start,n.end)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(64);t.default=function(e,t){if(e.currentIndex<0||t!=e.snapshots[e.currentIndex]){r.default(e),e.snapshots.push(t),e.currentIndex++,e.totalSize+=t.length;for(var n=0;n<e.snapshots.length&&e.totalSize>e.maxSize;)e.totalSize-=e.snapshots[n].length,n++;n>0&&(e.snapshots.splice(0,n),e.currentIndex-=n)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(42);t.default=function(e,t){return r.default(e,t)?(e.currentIndex+=t,e.snapshots[e.currentIndex]):null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{snapshots:[],totalSize:0,currentIndex:-1,maxSize:e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(65),o=n(66),i=n(35),a=n(67),s=n(128),l=function(){function e(e){e=e||{},this.elementCallbacks=a.cloneObject(e.elementCallbacks),this.styleCallbacks=s.getStyleCallbacks(e.styleCallbacks),this.attributeCallbacks=a.cloneObject(e.attributeCallbacks),this.allowedTags=s.getAllowedTags(e.additionalAllowedTags),this.allowedAttributes=s.getAllowedAttributes(e.additionalAllowAttributes),this.allowedCssClassesRegex=s.getAllowedCssClassesRegex(e.additionalAllowedCssClasses),this.defaultStyleValues=s.getDefaultStyleValues(e.additionalDefaultStyleValues),this.additionalGlobalStyleNodes=e.additionalGlobalStyleNodes||[],this.allowPreserveWhiteSpace=e.allowPreserveWhiteSpace}return e.convertInlineCss=function(t,n){return new e({additionalGlobalStyleNodes:n}).exec(t,!0)},e.sanitizeHtml=function(t,n){var o=new e(n=n||{}),a=i.default(n.currentElementOrStyle)?r.default(n.currentElementOrStyle):n.currentElementOrStyle;return o.exec(t,n.convertCssOnly,n.preserveFragmentOnly,a)},e.prototype.exec=function(e,t,n,r){var i=o.default(e,n);return i&&(this.convertGlobalCssToInlineCss(i),t||this.sanitize(i.body,r)),i&&i.body&&i.body.innerHTML||""},e.prototype.sanitize=function(e,t){if(!e)return"";t=a.cloneObject(t,r.default(null)),this.processNode(e,t,{})},e.prototype.convertGlobalCssToInlineCss=function(e){for(var t=u(e.querySelectorAll("style")),n=0,r=this.additionalGlobalStyleNodes.reverse().map((function(e){return e.sheet})).concat(t.map((function(e){return e.sheet})).reverse()).filter((function(e){return e}));n<r.length;n++)for(var o=r[n],i=function(t){var n=o.cssRules[t],r=n&&n.style?n.style.cssText:null;if(n.type!=CSSRule.STYLE_RULE||!r||!n.selectorText)return"continue";for(var i=0,a=n.selectorText.split(",");i<a.length;i++){var s=a[i];if(s&&s.trim()&&!(s.indexOf(":")>=0))u(e.querySelectorAll(s)).forEach((function(e){return e.setAttribute("style",r+(e.getAttribute("style")||""))}))}},a=o.cssRules.length-1;a>=0;a--)i(a);t.forEach((function(e){e.parentNode&&e.parentNode.removeChild(e)}))},e.prototype.processNode=function(e,t,n){var r=e.nodeType,o=1==r,i=3==r,s=11==r,l=e,u=o?l.tagName.toUpperCase():"";if(o&&!this.allowElement(l,u,n)||i&&/^[\r\n]*$/g.test(e.nodeValue)&&!t.insidePRE||!o&&!i&&!s)e.parentNode.removeChild(e);else if(i&&!this.allowPreserveWhiteSpace&&"pre"==t["white-space"])e.nodeValue=e.nodeValue.replace(/^ /gm," ").replace(/ {2}/g,"  ");else if(o||s){var d=a.cloneObject(t);o&&(this.processAttributes(l,n),this.processCss(l,u,d,n),"PRE"==u&&(d.insidePRE="true"));for(var c=l.firstChild,f=void 0;c;c=f)f=c.nextSibling,this.processNode(c,d,n)}},e.prototype.processCss=function(e,t,n,r){var o=this,i=e.getAttributeNode("style");if(i){var a=i.value.split(";"),s=a.filter((function(t){var i;if(!t||""==t.trim()||2!=(i=t.split(":")).length)return!1;var a=i[0].trim().toLowerCase(),s=i[1].trim().toLowerCase(),l=o.styleCallbacks[a],u=null!=n[a],d=(!l||l(s,e,r))&&"inherit"!=s&&s.indexOf("expression")<0&&"-"!=a.substr(0,1)&&o.defaultStyleValues[a]!=s&&(u&&s!=n[a]||!u&&"initial"!=s&&"normal"!=s);return d&&u&&(n[a]=s),d&&(o.allowPreserveWhiteSpace||"white-space"!=a)}));a.length!=s.length&&(s.length>0?e.setAttribute("style",s.map((function(e){return e.trim()})).join("; ")):e.removeAttribute("style"))}},e.prototype.processAttributes=function(e,t){for(var n=e.attributes.length-1;n>=0;n--){var r=e.attributes[n],o=r.name.toLowerCase().trim(),i=r.value,a=this.attributeCallbacks[o],s=a?a(i,e,t):this.allowedAttributes.indexOf(o)>=0||0==o.indexOf("data-")?i:null;"class"==o&&this.allowedCssClassesRegex&&(s=this.processCssClass(i,s)),null==s||s.match(/s\n*c\n*r\n*i\n*p\n*t\n*:/i)?e.removeAttribute(o):r.value=s}},e.prototype.processCssClass=function(e,t){var n=this,r=e?e.split(" "):[],o=t?t.split(" "):[];return r.forEach((function(e){n.allowedCssClassesRegex.test(e)&&o.indexOf(e)<0&&o.push(e)})),o.length>0?o.join(" "):null},e.prototype.allowElement=function(e,t,n){var r=this.elementCallbacks[t];return r?r(e,n):this.allowedTags.indexOf(t)>=0||t.indexOf(":")>0},e}();function u(e){return[].slice.call(e)}t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(67),o="BODY,H1,H2,H3,H4,H5,H6,FORM,P,BR,NOBR,HR,ACRONYM,ABBR,ADDRESS,B,BDI,BDO,BIG,BLOCKQUOTE,CENTER,CITE,CODE,DEL,DFN,EM,FONT,I,INS,KBD,MARK,METER,PRE,PROGRESS,Q,RP,RT,RUBY,S,SAMP,SMALL,STRIKE,STRONG,SUB,SUP,TEMPLATE,TIME,TT,U,VAR,WBR,XMP,INPUT,TEXTAREA,BUTTON,SELECT,OPTGROUP,OPTION,LABEL,FIELDSET,LEGEND,DATALIST,OUTPUT,IMG,MAP,AREA,CANVAS,FIGCAPTION,FIGURE,PICTURE,A,NAV,UL,OL,LI,DIR,UL,DL,DT,DD,MENU,MENUITEM,TABLE,CAPTION,TH,TR,TD,THEAD,TBODY,TFOOT,COL,COLGROUP,DIV,SPAN,HEADER,FOOTER,MAIN,SECTION,ARTICLE,ASIDE,DETAILS,DIALOG,SUMMARY,DATA".split(","),i="accept,align,alt,checked,cite,color,cols,colspan,contextmenu,coords,datetime,default,dir,dirname,disabled,download,face,headers,height,hidden,high,href,hreflang,ismap,kind,label,lang,list,low,max,maxlength,media,min,multiple,open,optimum,pattern,placeholder,readonly,rel,required,reversed,rows,rowspan,scope,selected,shape,size,sizes,span,spellcheck,src,srclang,srcset,start,step,style,tabindex,target,title,translate,type,usemap,value,width,wrap".split(","),a={"background-color":"transparent","border-bottom-color":"rgb(0, 0, 0)","border-bottom-style":"none","border-bottom-width":"0px","border-image-outset":"0","border-image-repeat":"stretch","border-image-slice":"100%","border-image-source":"none","border-image-width":"1","border-left-color":"rgb(0, 0, 0)","border-left-style":"none","border-left-width":"0px","border-right-color":"rgb(0, 0, 0)","border-right-style":"none","border-right-width":"0px","border-top-color":"rgb(0, 0, 0)","border-top-style":"none","border-top-width":"0px","outline-color":"transparent","outline-style":"none","outline-width":"0px",overflow:"visible","text-decoration":"none","-webkit-text-stroke-width":"0px","word-wrap":"break-word","margin-left":"0px","margin-right":"0px",padding:"0px","padding-top":"0px","padding-left":"0px","padding-right":"0px","padding-bottom":"0px",border:"0px","border-top":"0px","border-left":"0px","border-right":"0px","border-bottom":"0px","vertical-align":"baseline",float:"none"},s=[];function l(){return null}function u(e,t){var n=t.tagName;return!("LI"==n||"DIV"==n)}function d(e){return e.filter((function(e,t,n){return n.indexOf(e)==t}))}t.getAllowedTags=function(e){return d(o.concat(e||[])).map((function(e){return e.toUpperCase()}))},t.getAllowedAttributes=function(e){return d(i.concat(e||[])).map((function(e){return e.toLocaleLowerCase()}))},t.getAllowedCssClassesRegex=function(e){var t=s.concat(e||[]);return t.length>0?new RegExp(t.join("|")):null},t.getDefaultStyleValues=function(e){var t=r.cloneObject(a);return e&&Object.keys(e).forEach((function(n){var r=e[n];null!=r?t[n]=r:delete t[n]})),t},t.getStyleCallbacks=function(e){var t=r.cloneObject(e);return t.position=t.position||l,t.width=t.width||u,t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return{elementCallbacks:{},attributeCallbacks:{},styleCallbacks:{},additionalAllowedTags:[],additionalAllowAttributes:[],additionalAllowedCssClasses:[],additionalDefaultStyleValues:{},additionalGlobalStyleNodes:[],allowPreserveWhiteSpace:!1}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(e[t]){var r=e[t];e[t]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.apply(void 0,e),n.apply(void 0,e)}}else e[t]=n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6);t.default=function(e){return r.default(e,"DocumentFragment")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6);t.default=function(e){return r.default(e,"HTMLOListElement")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(17),i=n(2),a=/[.+=\s:;"',>]+$/i;function s(e,t){return 0==e.eventType||6==e.eventType&&"Paste"==e.source?i.cacheGetEventData(e,"LINK_DATA",(function(){var n=6==e.eventType&&"Paste"==e.source&&e.data,o=r.matchLink((n.text||"").trim()),s=i.cacheGetContentSearcher(e,t);if(o&&s.getRangeFromText(o.originalUrl,!1))return o;var l=s&&s.getWordBefore();if(l&&l.length>5){var u=(l.match(a)||[])[0]||"",d=l.substring(0,l.length-u.length);return["()","{}","[]"].forEach((function(e){d[d.length-1]==e[1]&&d.indexOf(e[0])<0&&(d=d.substr(0,d.length-1))})),r.matchLink(d)}return null})):null}t.AutoLink={keys:[13,32,2048],shouldHandleEvent:s,handleEvent:function(e,t){var n=t.getDocument().createElement("a"),r=s(e,t),a=t.getContentSearcherOfCursor();n.textContent=r.originalUrl,n.href=r.normalizedUrl,t.runAsync((function(){t.performAutoComplete((function(){return o.replaceWithNode(t,r.originalUrl,n,!1,a),i.clearContentSearcherCache(e),n}),"AutoLink")}))}},t.UnlinkWhenBackspaceAfterLink={keys:[8],shouldHandleEvent:function(e,t){return i.cacheGetContentSearcher(e,t).getInlineElementBefore()instanceof r.LinkInlineElement},handleEvent:function(e,t){e.rawEvent.preventDefault(),o.removeLink(t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(18),o=n(0);t.FONT_SIZES=[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72];function i(e,t,n){e=1==t?Math.floor(e):Math.ceil(e);var r=n[n.length-1];if(e<=n[0])e=Math.max(e+t,1);else if(e>r||e==r&&1==t)e/=10,e=1==t?Math.floor(e):Math.ceil(e),e=Math.min(Math.max(10*(e+t),r),1e3);else if(1==t){for(var o=0;o<n.length;o++)if(e<n[o]){e=n[o];break}}else for(o=n.length-1;o>=0;o--)if(e>n[o]){e=n[o];break}return e}t.default=function(e,n,a){void 0===a&&(a=t.FONT_SIZES);var s=0==n?1:-1;r.default(e,(function(e){var t=parseFloat(o.getComputedStyle(e,"font-size"));e.style.fontSize=i(t,s,a)+"pt","normal"!=o.getComputedStyle(e,"line-height")&&(e.style.lineHeight="normal")}))},t.getNewFontSize=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(68),o=n(0);function i(e,t){return e.indexOf(o.getTagOfNode(t))<0}t.TAGS_TO_UNWRAP="B,I,U,STRONG,EM,SUB,SUP,STRIKE,FONT,CENTER,H1,H2,H3,H4,H5,H6,UL,OL,LI,SPAN,P,BLOCKQUOTE,CODE,S,PRE".split(","),t.TAGS_TO_STOP_UNWRAP=["TD","TH","TR","TABLE","TBODY","THEAD"],t.ATTRIBUTES_TO_PRESERVE=["href"],t.default=function(e,n,a,s){void 0===n&&(n=t.TAGS_TO_UNWRAP),void 0===a&&(a=t.TAGS_TO_STOP_UNWRAP),void 0===s&&(s=t.ATTRIBUTES_TO_PRESERVE),e.focus(),e.addUndoSnapshot((function(t,l){var u=[{}],d=a.join(",");r.default(e,(function(t){var n=u[u.length-1],r=e.getElementAtCursor(d,t);r!=n.td&&n.first&&u.push(n={}),n.td=r,n.first=n.first||t,n.last=t})),u.filter((function(e){return e.first})).forEach((function(t){var r=e.collapseNodes(t.first,t.last,!0);if(i(a,r[0]))for(;e.contains(r[0].parentNode)&&i(a,r[0].parentNode);)r=[o.splitBalancedNodeRange(r)];if(r.forEach((function(e){return function e(t,n,r,a){if(1!=t.nodeType||"BR"==o.getTagOfNode(t))return!1;var s=o.toArray(t.childNodes).map((function(t){return e(t,n,r,a)})).reduce((function(e,t){return e&&t}),!0);if(!i(r,t))return!1;var l=o.isBlockElement(t);n.indexOf(o.getTagOfNode(t))>=0||s?(l&&!s&&o.wrap(t),o.unwrap(t)):function(e,t){for(var n=0,r=o.toArray(e.attributes);n<r.length;n++){var i=r[n];t.indexOf(i.name.toLowerCase())<0&&0!=i.name.indexOf("data-")&&e.removeAttribute(i.name)}}(t,a);return l}(e,n,a,s)})),t.td){var l=t.td.getAttribute("style")||"",u=l.split(";");(l=(u=u.filter((function(e){return 0==e.trim().toLowerCase().indexOf("border")}))).join(";"))?t.td.setAttribute("style",l):t.td.removeAttribute("style")}})),e.select(t,l)}),"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(10),o=n(69),i=n(70),a=n(71),s=n(72),l=n(73),u=n(74),d=n(75),c=["font","text-decoration","color","background"];t.default=function(e){e.focus(),e.addUndoSnapshot((function(){r.default(e,"removeFormat"),e.queryElements("[class]",1,(function(e){return e.removeAttribute("class")}));var t=e.getDefaultFormat(),n=0===Object.keys(t).length;e.queryElements("[style]",2,(function(e){c.forEach((function(t){return e.style.removeProperty(t)})),n&&""===e.getAttribute("style")&&e.removeAttribute("style")})),n||(t.fontFamily&&i.default(e,t.fontFamily),t.fontSize&&a.default(e,t.fontSize),t.textColor&&(t.textColors?s.default(e,t.textColors):s.default(e,t.textColor)),t.backgroundColor&&(t.backgroundColors?o.default(e,t.backgroundColors):o.default(e,t.backgroundColor)),t.bold&&l.default(e),t.italic&&u.default(e),t.underline&&d.default(e))}),"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=/^[a-zA-Z]+:/i,i=/^[\w.%+-]+@/i,a=/^ftp\./i;function s(e){return e.queryElements("a[href]",1)[0]}function l(e,t){t&&e.textContent!=t&&(e.textContent=t)}t.default=function(e,t,n,u){e.focus();var d=(function(e){var t=new r.HtmlSanitizer,n=(new DOMParser).parseFromString("<a></a>","text/html"),o=n.body.firstChild;return o.href=e||"",t.sanitize(n.body),o.getAttribute("href")}(t)||"").trim();if(d){var c=r.matchLink(d),f=c?c.normalizedUrl:function(e){if(!e)return e;var t="";return e.search(o)<0&&(t=0==e.search(i)?"mailto:":0==e.search(a)?"ftp://":"http://"),t+e}(d),p=c?c.originalUrl:d;e.addUndoSnapshot((function(){var t=e.getSelectionRange(),r=null;return t&&t.collapsed?(r=s(e))?(r.href=f,l(r,u)):((r=e.getDocument().createElement("A")).textContent=u||p,r.href=f,e.insertNode(r)):(e.getDocument().execCommand("createLink",!1,f),l(r=s(e),u)),n&&r&&(r.removeAttribute("istemptitle"),r.title=n),r}),"CreateLink")}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),i=n(0),a=n(0);function s(e,t){var n=a.getTagOfNode(o.cacheGetElementAtCursor(e,t,"OL,UL")),r=a.getTagOfNode(o.cacheGetElementAtCursor(e,t,"H1,H2,H3,H4,H5,H6"));return{isBullet:"UL"==n,isNumbering:"OL"==n,headerLevel:r&&parseInt(r[1])||0,canUnlink:!!e.queryElements("a[href]",1)[0],canAddImageAltText:!!e.queryElements("img",1)[0],isBlockQuote:!!e.queryElements("blockquote",1)[0]}}t.getElementBasedFormatState=s,t.getStyleBasedFormatState=function(e){return e.getStyleBasedFormatState()},t.default=function(e,t){return r(r(r(r({},i.getPendableFormatState(e.getDocument())),s(e,t)),e.getStyleBasedFormatState()),{canUndo:e.canUndo(),canRedo:e.canRedo()})}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(140),i=n(141),a=n(153),s=n(77),l=n(89),u=n(154),d=n(0),c=function(){function e(e,t){var n=this;if(void 0===t&&(t={}),"DIV"!=d.getTagOfNode(e))throw new Error("contentDiv must be an HTML DIV element");if(this.core=i.default(e,t),this.enableExperimentFeatures=t.enableExperimentFeatures,this.core.plugins.forEach((function(e){return e.initialize(n)})),this.setContent(t.initialContent||e.innerHTML||"",!1),this.eventDisposers=a.default(this.core),t.additionalEditFeatures&&t.additionalEditFeatures.forEach((function(e){return n.addContentEditFeature(e)})),!t.omitContentEditableAttributeChanges&&!e.isContentEditable){e.setAttribute("contenteditable","true");var r=e.style;r.userSelect=r.msUserSelect=r.webkitUserSelect="text",this.contenteditableChanged=!0}o.default(this.core.document),this.triggerPluginEvent(10,{},!0),this.core.corePlugins.typeInContainer.ensureTypeInElement(this.getFocusedPosition()||new d.Position(e,0))}return e.prototype.dispose=function(){this.triggerPluginEvent(11,{},!0),this.core.plugins.forEach((function(e){return e.dispose()})),this.eventDisposers.forEach((function(e){return e()})),this.eventDisposers=null;for(var e=0,t=Object.keys(this.core.customData);e<t.length;e++){var n=t[e],r=this.core.customData[n];r&&r.disposer&&r.disposer(r.value),delete this.core.customData[n]}if(this.contenteditableChanged){var o=this.core.contentDiv.style;o.userSelect=o.msUserSelect=o.webkitUserSelect="",this.core.contentDiv.removeAttribute("contenteditable")}this.core=null},e.prototype.isDisposed=function(){return!this.core},e.prototype.insertNode=function(e,t){var n=this.getDarkModeOptions(),r=this.isDarkMode()?u.convertContentToDarkMode(e,n&&n.onExternalContentTransform?n.onExternalContentTransform:void 0):null,o=!!e&&this.core.api.insertNode(this.core,e,t);return o&&r&&r(),o},e.prototype.deleteNode=function(e){return!(!e||!this.contains(e))&&(e.parentNode.removeChild(e),!0)},e.prototype.replaceNode=function(e,t){return!!(e&&t&&this.contains(e))&&(e.parentNode.replaceChild(t,e),!0)},e.prototype.getInlineElementAtNode=function(e){return d.getInlineElementAtNode(this.core.contentDiv,e)},e.prototype.getBlockElementAtNode=function(e){return d.getBlockElementAtNode(this.core.contentDiv,e)},e.prototype.contains=function(e){return d.contains(this.core.contentDiv,e)},e.prototype.queryElements=function(e,t,n){void 0===t&&(t=0);var r=t instanceof Function?0:t;n=t instanceof Function?t:n;var o=0==r?null:this.getSelectionRange();return d.queryElements(this.core.contentDiv,e,n,r,o)},e.prototype.collapseNodes=function(e,t,n){return d.collapseNodes(this.core.contentDiv,e,t,n)},e.prototype.isEmpty=function(e){return d.isNodeEmpty(this.core.contentDiv,e)},e.prototype.getContent=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!1);var n="",r=this.core.inDarkMode;if(e||r){var o=this.core.contentDiv.cloneNode(!0),i=t&&this.getSelectionPath(),a=i&&d.createRange(o,i.start,i.end);r&&s.default(o),e?(this.triggerPluginEvent(8,{clonedRoot:o},!0),n=this.triggerPluginEvent(7,{content:o.innerHTML},!0).content):n=a?d.getHtmlWithSelectionPath(o,a):o.innerHTML}else n=d.getHtmlWithSelectionPath(this.core.contentDiv,t&&this.getSelectionRange());return n},e.prototype.getTextContent=function(){return d.getTextContent(this.core.contentDiv)},e.prototype.setContent=function(e,t){void 0===t&&(t=!0);var n=this.core.contentDiv,r=!1;if(n.innerHTML!=e){var o=d.setHtmlWithSelectionPath(n,e);this.select(o),r=!0}if(this.core.inDarkMode){var i=this.getDarkModeOptions(),a=u.convertContentToDarkMode(n,i&&i.onExternalContentTransform?i.onExternalContentTransform:void 0,!0);a&&(a(),r=!0)}t&&r&&this.triggerContentChangedEvent()},e.prototype.insertContent=function(e,t){if(e){var n=d.fromHtml(e,this.core.document);t&&t.insertOnNewLine&&n.length>1&&(n=[d.wrap(n)]);var r=this.core.document.createDocumentFragment();n.forEach((function(e){return r.appendChild(e)})),this.insertNode(r,t)}},e.prototype.paste=function(e,t,n){var r=this,o=this.getSelectionRange(),i=o&&d.Position.getStart(o);if(e&&i){e.snapshotBeforePaste?this.setContent(e.snapshotBeforePaste):e.snapshotBeforePaste=this.getContent(!1,!0);var a=this.core.api.createPasteFragment(this.core,e,i,t,n);this.addUndoSnapshot((function(){return r.insertNode(a),e}),"Paste")}},e.prototype.getSelectionRange=function(){return this.core.api.getSelectionRange(this.core,!0)},e.prototype.getSelectionPath=function(){var e=this.getSelectionRange();return e&&d.getSelectionPath(this.core.contentDiv,e)},e.prototype.hasFocus=function(){return this.core.api.hasFocus(this.core)},e.prototype.focus=function(){this.core.api.focus(this.core)},e.prototype.select=function(e,t,n,r){var o=e?d.isRange(e)?e:Array.isArray(e.start)&&Array.isArray(e.end)?d.createRange(this.core.contentDiv,e.start,e.end):d.createRange(e,t,n,r):null;return this.contains(o)&&this.core.api.selectRange(this.core,o)},e.prototype.getSelection=function(){return this.core.document.defaultView.getSelection()},e.prototype.saveSelectionRange=function(){this.core.cachedSelectionRange=this.core.api.getSelectionRange(this.core,!1)},e.prototype.restoreSavedRange=function(){this.select(this.core.cachedSelectionRange),this.core.cachedSelectionRange=null},e.prototype.getFocusedPosition=function(){var e=this.getSelection();if(this.contains(e&&e.focusNode))return new d.Position(e.focusNode,e.focusOffset);var t=this.getSelectionRange();return t?d.Position.getStart(t):null},e.prototype.getCursorRect=function(){var e=this.getFocusedPosition();return e&&d.getPositionRect(e)},e.prototype.getElementAtCursor=function(e,t){if(!t){var n=this.getFocusedPosition();t=n&&n.node}return t&&d.findClosestElementAncestor(t,this.core.contentDiv,e)},e.prototype.isPositionAtBeginning=function(e){return d.isPositionAtBeginningOf(e,this.core.contentDiv)},e.prototype.getSelectedRegions=function(e){void 0===e&&(e=0),this.core.corePlugins.typeInContainer.ensureTypeInElement(this.getFocusedPosition()||new d.Position(this.core.contentDiv,0));var t=this.getSelectionRange();return t?d.getRegionsFromRange(this.core.contentDiv,t,e):[]},e.prototype.addDomEventHandler=function(e,t){var n=this;if(e instanceof Object){var r=Object.keys(e).map((function(t){return e[t]&&n.core.api.attachDomEvent(n.core,t,null,e[t])})).filter((function(e){return e}));return function(){return r.forEach((function(e){return e()}))}}return this.core.api.attachDomEvent(this.core,e,null,t)},e.prototype.triggerPluginEvent=function(e,t,n){var o=r({eventType:e},t);return this.core.api.triggerEvent(this.core,o,n),o},e.prototype.triggerEvent=function(e,t){void 0===t&&(t=!0),this.core.api.triggerEvent(this.core,e,t)},e.prototype.triggerContentChangedEvent=function(e,t){void 0===e&&(e="SetContent"),this.triggerPluginEvent(6,{source:e,data:t})},e.prototype.undo=function(){this.focus(),this.core.corePlugins.undo.undo()},e.prototype.redo=function(){this.focus(),this.core.corePlugins.undo.redo()},e.prototype.addUndoSnapshot=function(e,t){this.core.api.editWithUndo(this.core,e,t)},e.prototype.performAutoComplete=function(e,t){this.core.corePlugins.edit.performAutoComplete(e,t)},e.prototype.canUndo=function(){return this.core.corePlugins.undo.canUndo()},e.prototype.canRedo=function(){return this.core.corePlugins.undo.canRedo()},e.prototype.getDocument=function(){return this.core.document},e.prototype.getScrollContainer=function(){return this.core.scrollContainer},e.prototype.getCustomData=function(e,t,n){return this.core.api.getCustomData(this.core,e,t,n)},e.prototype.isInIME=function(){return this.core.corePlugins.domEvent.isInIME()},e.prototype.getDefaultFormat=function(){return this.core.defaultFormat},e.prototype.getBodyTraverser=function(e){return d.ContentTraverser.createBodyTraverser(this.core.contentDiv,e)},e.prototype.getSelectionTraverser=function(){return this.getSelectionRange()&&d.ContentTraverser.createSelectionTraverser(this.core.contentDiv,this.getSelectionRange())},e.prototype.getBlockTraverser=function(e){void 0===e&&(e=3);var t=this.getSelectionRange();return t&&d.ContentTraverser.createBlockTraverser(this.core.contentDiv,t,e)},e.prototype.getContentSearcherOfCursor=function(){var e=this.getSelectionRange();return e&&new d.PositionContentSearcher(this.core.contentDiv,d.Position.getStart(e))},e.prototype.runAsync=function(e){var t=this;(this.core.contentDiv.ownerDocument.defaultView||window).requestAnimationFrame((function(){!t.isDisposed()&&e&&e()}))},e.prototype.setEditorDomAttribute=function(e,t){null===t?this.core.contentDiv.removeAttribute(e):this.core.contentDiv.setAttribute(e,t)},e.prototype.getEditorDomAttribute=function(e){return this.core.contentDiv.getAttribute(e)},e.prototype.addContentEditFeature=function(e){this.core.corePlugins.edit.addFeature(e)},e.prototype.getStyleBasedFormatState=function(e){if(!e){var t=this.getSelectionRange();e=t&&d.Position.getStart(t).normalize().node}return this.core.api.getStyleBasedFormatState(this.core,e)},e.prototype.setDarkModeState=function(e){if(this.isDarkMode()!=e){var t=this.getContent(void 0,!0);this.core.inDarkMode=e,this.core.defaultFormat=l.calculateDefaultFormat(this.core.contentDiv,this.core.defaultFormat,this.core.inDarkMode),this.setContent(t),this.triggerPluginEvent(14,{changedToDarkMode:e})}},e.prototype.isDarkMode=function(){return this.core.inDarkMode},e.prototype.getDarkModeOptions=function(){return this.core.darkModeOptions},e.prototype.useExperimentFeatures=function(){return!!this.enableExperimentFeatures},e}();t.default=c},function(e,t,n){"use strict";var r,o;Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=i.Browser.isFirefox?((r={}).enableObjectResizing=!1,r.enableInlineTableEditing=!1,r):i.Browser.isIE?((o={}).defaultParagraphSeparator="div",o.AutoUrlDetect=!1,o):{};t.default=function(e){Object.keys(a).forEach((function(t){try{e.execCommand(t,!1,a[t])}catch(e){}}))}},function(e,t,n){"use strict";var r=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r};Object.defineProperty(t,"__esModule",{value:!0});var o=n(76),i=n(78),a=n(79),s=n(80),l=n(81),u=n(84),d=n(85),c=n(86),f=n(143),p=n(0),h=n(89),v=n(144),g=n(145),m=n(146),y=n(147),E=n(148),b=n(149),S=n(90),C=n(150),O=n(151),N=n(152);function w(e){return{attachDomEvent:(e=e||{}).attachDomEvent||f.attachDomEvent,editWithUndo:e.editWithUndo||g.editWithUndo,focus:e.focus||m.focus,getCustomData:e.getCustomData||y.getCustomData,getSelectionRange:e.getSelectionRange||E.getSelectionRange,getStyleBasedFormatState:e.getStyleBasedFormatState||b.getStyleBasedFormatState,hasFocus:e.hasFocus||S.hasFocus,insertNode:e.insertNode||C.insertNode,createPasteFragment:e.createPasteFragment||v.createPasteFragment,select:e.select||O.select,selectRange:e.selectRange||O.selectRange,triggerEvent:e.triggerEvent||N.triggerEvent}}t.default=function(e,t){var n,f={undo:t.undo||new c.default,edit:new s.default,typeInContainer:new d.default,mouseUp:new u.default,domEvent:new a.default(t.disableRestoreSelectionOnFocus),firefoxTypeAfterLink:new l.default,copyPlugin:!p.Browser.isIE&&new o.default,pastePlugin:new i.default},v=function(e,t){return r([e.typeInContainer,e.edit,e.mouseUp],t||[],[e.firefoxTypeAfterLink,e.undo,e.domEvent,e.copyPlugin,e.pastePlugin]).filter((function(e){return!!e}))}(f,t.plugins),g=v.filter((function(e){return e.onPluginEvent||e.willHandleEventExclusively}));return{contentDiv:e,scrollContainer:t.scrollContainer||e,document:e.ownerDocument,defaultFormat:h.calculateDefaultFormat(e,t.defaultFormat,t.inDarkMode),corePlugins:f,currentUndoSnapshot:null,customData:(n=t.customData||{},Object.keys(n).reduce((function(e,t){return e[t]={value:n[t]},e}),{})),cachedSelectionRange:null,plugins:v,eventHandlerPlugins:g,api:w(t.coreApiOverride),defaultApi:w(),inDarkMode:t.inDarkMode,darkModeOptions:t.darkModeOptions}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=function(){function e(e){void 0===e&&(e=1e7),this.maxSize=e,this.snapshots=r.createSnapshots(e)}return e.prototype.canMove=function(e){return r.canMoveCurrentSnapshot(this.snapshots,e)},e.prototype.move=function(e){return r.moveCurrentSnapsnot(this.snapshots,e)},e.prototype.addSnapshot=function(e){r.addSnapshot(this.snapshots,e)},e.prototype.clearRedo=function(){r.clearProceedingSnapshots(this.snapshots)},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(87);t.attachDomEvent=function(e,t,n,o){var i=function(t){var i;(("keydown"==(i=t).type||"keypress"==i.type||"keyup"==i.type)&&r.default(t)||12==n)&&t.stopPropagation(),o&&o(t),null!=n&&e.api.triggerEvent(e,{eventType:n,rawEvent:t},!1)};return e.contentDiv.addEventListener(t,i),function(){e.contentDiv.removeEventListener(t,i)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);function o(e,t){for(var n=e.querySelectorAll("style"),r=0;r<n.length;r++)t(n[r])}t.createPasteFragment=function(e,t,n,i,a){var s,l,u,d=function(e,t,n){var o=n?1:t.text||!t.image?0:2,i=e.document.createDocumentFragment();return{eventType:9,clipboardData:t,pasteOption:o,fragment:i,sanitizingOption:r.createDefaultHtmlSanitizerOptions(),htmlBefore:"",htmlAfter:"",htmlAttributes:{}}}(e,t,i),c=d.fragment,f=d.pasteOption,p=d.sanitizingOption,h=t.rawHtml,v=t.text,g=t.imageDataUri;if(2==f&&g){var m=e.document.createElement("img");m.style.maxWidth="100%",m.src=g,c.appendChild(m)}else if(0==f&&h&&(null===(s=u=(new DOMParser).parseFromString(h,"text/html"))||void 0===s?void 0:s.body)){var y=null===(l=u.querySelector("html"))||void 0===l?void 0:l.attributes;(y?r.toArray(y):[]).reduce((function(e,t){return e[t.name]=t.value,e}),d.htmlAttributes),r.toArray(u.querySelectorAll("meta")).reduce((function(e,t){return e[t.name]=t.content,e}),d.htmlAttributes),o(u,(function(e){u.head.appendChild(e),p.additionalGlobalStyleNodes.push(e)}));var E=h.indexOf("\x3c!--StartFragment--\x3e"),b=h.lastIndexOf("\x3c!--EndFragment--\x3e");for(E>=0&&b>=E+"\x3c!--StartFragment--\x3e".length&&(d.htmlBefore=h.substr(0,E),d.htmlAfter=h.substr(b+"\x3c!--EndFragment--\x3e".length),u.body.innerHTML=t.html=h.substring(E+"\x3c!--StartFragment--\x3e".length,b),o(u.body,(function(e){var t;return null===(t=e.parentNode)||void 0===t?void 0:t.removeChild(e)})));u.body.firstChild;)c.appendChild(u.body.firstChild);if(a&&n){var S=function(e,t){var n=r.getPendableFormatState(e.document),o=e.api.getStyleBasedFormatState(e,t);return{fontFamily:o.fontName,fontSize:o.fontSize,textColor:o.textColor,backgroundColor:o.backgroundColor,textColors:o.textColors,backgroundColors:o.backgroundColors,bold:n.isBold,italic:n.isItalic,underline:n.isUnderline}}(e,n.node);r.applyTextStyle(c,(function(e){return r.applyFormat(e,S)}))}}else v&&v.split("\n").forEach((function(e,t,n){var o=""==(e=e.replace(/^ /g," ").replace(/\r/g,"").replace(/ {2}/g,"  "))?document.createElement("br"):document.createTextNode(e);c.appendChild(0==t||t==n.length-1?o:r.wrap(o))}));e.api.triggerEvent(e,d,!0);var C=new r.HtmlSanitizer(d.sanitizingOption);return C.convertGlobalCssToInlineCss(c),C.sanitize(c,n&&r.getInheritableStyles(n.element)),c}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.editWithUndo=function(e,t,n){var o,i=null!==e.currentUndoSnapshot;i||(e.currentUndoSnapshot=e.corePlugins.undo.addUndoSnapshot());try{if(t){var a=e.api.getSelectionRange(e,!0);o=t(a&&r.Position.getStart(a).normalize(),a&&r.Position.getEnd(a).normalize(),e.currentUndoSnapshot),i||e.corePlugins.undo.addUndoSnapshot()}}finally{i||(e.currentUndoSnapshot=null)}if(t&&n){var s={eventType:6,source:n,data:o};e.api.triggerEvent(e,s,!0)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.focus=function(e){if(!(e.api.hasFocus(e)&&e.api.getSelectionRange(e,!1)||e.cachedSelectionRange&&e.api.selectRange(e,e.cachedSelectionRange,!0))){var t=r.getFirstLeafNode(e.contentDiv)||e.contentDiv;e.api.selectRange(e,r.createRange(t,0),!0)}e.cachedSelectionRange=null,e.api.hasFocus(e)||e.contentDiv.focus()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCustomData=function(e,t,n,r){return(e.customData[t]=e.customData[t]||{value:n?n():void 0,disposer:r}).value}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.getSelectionRange=function(e,t){var n=null;if(!t||e.api.hasFocus(e)){var o=e.document.defaultView.getSelection();if(o&&o.rangeCount>0){var i=o.getRangeAt(0);r.contains(e.contentDiv,i)&&(n=i)}}return!n&&t&&(n=e.cachedSelectionRange),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.getStyleBasedFormatState=function(e,t){if(!t)return{};var n=t?r.getComputedStyles(t):[],o=e.inDarkMode,i=e.contentDiv,a=o&&r.findClosestElementAncestor(t,i,"[data-ogsc],[data-ogac]"),s=o&&r.findClosestElementAncestor(t,i,"[data-ogsb],[data-ogab]");return{fontName:n[0],fontSize:n[1],textColor:n[2],backgroundColor:n[3],textColors:a?{darkModeColor:n[2],lightModeColor:a.dataset.ogsc||a.dataset.ogac}:void 0,backgroundColors:s?{darkModeColor:n[3],lightModeColor:s.dataset.ogsb||s.dataset.ogab}:void 0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.insertNode=function(e,t,n){n=n||{position:3,insertOnNewLine:!1,updateCursor:!0,replaceSelection:!0};var o=e.contentDiv;switch(n.updateCursor&&e.api.focus(e),n.position){case 0:case 1:var i,a=0==n.position,s=r.getFirstLastBlockElement(o,a);if(s){var l=a?s.getStartNode():s.getEndNode();i=n.insertOnNewLine||3==l.nodeType||r.isVoidHtmlElement(l)?l.parentNode.insertBefore(t,a?l:l.nextSibling):l.insertBefore(t,a?l.firstChild:null)}else i=o.appendChild(t);i&&n.insertOnNewLine&&!r.isBlockElement(i)&&r.wrap(i);break;case 2:var u=o.appendChild(t);u&&n.insertOnNewLine&&!r.isBlockElement(u)&&r.wrap(u);break;case 5:case 3:var d=function(e,t){var n=e.api.getSelectionRange(e,!0),r=null;return 5==t.position?(r=n,n=t.range):n&&(r=n.cloneRange()),{range:n,rangeToRestore:r}}(e,n),c=d.range,f=d.rangeToRestore;if(!c)return;n.replaceSelection&&!c.collapsed&&c.deleteContents();var p=r.Position.getStart(c),h=void 0;p=n.insertOnNewLine&&(h=r.getBlockElementAtNode(o,p.normalize().node))?new r.Position(h.getEndNode(),-3):r.adjustNodeInsertPosition(o,t,p);var v=11==t.nodeType?t.lastChild:t;(c=r.createRange(p)).insertNode(t),n.updateCursor&&v&&(f=r.createRange(new r.Position(v,-3).normalize())),e.api.selectRange(e,f);break;case 4:e.contentDiv.parentNode.insertBefore(t,o.nextSibling)}return!0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(90);t.selectRange=function(e,t,n){var i,a=!0;if(!r.contains(e.contentDiv,t)||!(i=e.document.defaultView.getSelection()))return!1;if(i.rangeCount>0)try{var s=void 0;(n||r.Browser.isEdge)&&(s=1==i.rangeCount?i.getRangeAt(0):null)&&s.startContainer==t.startContainer&&s.startOffset==t.startOffset&&s.endContainer==t.endContainer&&s.endOffset==t.endOffset?a=!1:i.removeAllRanges()}catch(e){}return a&&i.addRange(t),o.hasFocus(e)||(e.cachedSelectionRange=t),t.collapsed&&e.corePlugins.domEvent.restorePendingFormatState(),!0},t.select=function(e,t,n,o,i){var a=r.isRange(t)?t:r.createRange(t,n,o,i);return e.api.selectRange(e,a)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.triggerEvent=function(e,t,n){!n&&e.eventHandlerPlugins.some((function(e){return function(e,t){if(t.onPluginEvent&&t.willHandleEventExclusively&&t.willHandleEventExclusively(e))return t.onPluginEvent(e),!0;return!1}(t,e)}))||e.eventHandlerPlugins.forEach((function(e){e.onPluginEvent&&e.onPluginEvent(t)}))}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0});var o=((r={keypress:1,keydown:0,keyup:2,mousedown:4})[n(0).Browser.isIE?"textinput":"input"]=12,r);t.default=function(e){return Object.keys(o).map((function(t){return e.api.attachDomEvent(e,t,o[t])}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.convertContentToDarkMode=function(e,t,n){var o=[];return r.isHTMLElement(e)?(o=Array.prototype.slice.call(e.getElementsByTagName("*")),n||o.unshift(e)):r.isDocumentFragment(e)&&(o=Array.prototype.slice.call(e.querySelectorAll("*"))),o.length>0?function(){o.forEach((function(e){t?t(e):(e.style.color=null,e.style.backgroundColor=null)}))}:null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(44);t.default=function(e,t,n){return r.default(t,"GET_ELEMENT_AT_CURSOR_"+n,(function(){return e.getElementAtCursor(n)}))}},function(e,t,n){"use strict";function r(e,t){e.addUndoSnapshot((function(){var n=e.getDocument().createElement("img");n.src=t,n.style.maxWidth="100%",e.insertNode(n)}),"Format")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("string"==typeof t)r(e,t);else{var n=new FileReader;n.onload=function(t){e.isDisposed()||r(e,t.target.result)},n.readAsDataURL(t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);function o(e){return e<=4?"120px":e<=6?"100px":"70px"}t.default=function(e,t,n,i){var a=e.getDocument(),s=a.createDocumentFragment(),l=a.createElement("table");s.appendChild(l),l.cellSpacing="0",l.cellPadding="1";for(var u=0;u<n;u++){var d=a.createElement("tr");l.appendChild(d);for(var c=0;c<t;c++){var f=a.createElement("td");d.appendChild(f),f.appendChild(a.createElement("br")),f.style.width=o(t)}}e.focus(),e.addUndoSnapshot((function(){var t=new r.VTable(l);t.applyFormat(i||{bgColorEven:"#FFF",bgColorOdd:"#FFF",topBorderColor:"#ABABAB",bottomBorderColor:"#ABABAB",verticalBorderColor:"#ABABAB"}),t.writeBack(),e.insertNode(s),e.runAsync((function(){return e.select(new r.Position(l,0).normalize())}))}),"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e,t){var n=e.getElementAtCursor("TD,TH");n&&e.addUndoSnapshot((function(o,i){var a=new r.VTable(n);a.edit(t),a.writeBack(),e.focus(),e.select(o,i)||e.select(e.contains(n)?n:a.getCurrentTd())}),"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e,t,n){(n=n||e.getElementAtCursor("TABLE"))&&e.addUndoSnapshot((function(o,i){var a=new r.VTable(n);a.applyFormat(t),a.writeBack(),e.focus(),e.select(o,i)}),"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){e.focus(),e.addUndoSnapshot((function(t,n){e.queryElements("a[href]",1,r.unwrap),e.select(t,n)}),"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,r,o){if(!t||!n)return!1;var i;if(i="string"==typeof t?(o=o||e.getContentSearcherOfCursor())&&o.getRangeFromText(t,r):t){var a=e.getSelectionRange();return a.collapsed&&i.endContainer==a.startContainer&&i.endOffset==a.startOffset&&(r=!0),e.insertNode(n,{position:5,updateCursor:r,replaceSelection:!0,insertOnNewLine:!1,range:i}),!0}return!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(10);t.default=function(e,t){var n="justifyLeft",o="left";1==t?(n="justifyCenter",o="center"):2==t&&(n="justifyRight",o="right"),e.addUndoSnapshot((function(){r.default(e,n),e.queryElements("[align]",1,(function(e){return e.style.textAlign=o}))}),"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(68);t.default=function(e,t){e.focus(),e.addUndoSnapshot((function(n,o){r.default(e,(function(e){e.setAttribute("dir",0==t?"ltr":"rtl"),e.style.textAlign=0==t?"left":"right"})),e.select(n,o)}),"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){e.focus(),e.addUndoSnapshot((function(){e.queryElements("img",1,(function(e){return e.setAttribute("alt",t)}))}),"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(166),o=n(45);t.default=function(e,t){if(e.useExperimentFeatures())r.default(e,t);else{var n=0==t?"indent":"outdent";e.addUndoSnapshot((function(){var t;return e.focus(),e.getElementAtCursor("OL,UL")?t=o.default(e,n):(e.getDocument().execCommand(n,!1,null),e.queryElements("BLOCKQUOTE",1,(function(e){t=t||e,e.style.marginTop="0px",e.style.marginBottom="0px"}))),t}),"Format")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(91),o=n(0),i=n(0);function a(e,t){if(t.length>0){var n=t[0].getStartNode(),r=t[t.length-1].getEndNode(),o=i.collapseNodesInRegion(e,[n,r]);i.wrap(o,'<blockquote style="margin-top:0;margin-bottom:0"></blockquote>')}}function s(e,t){t.forEach((function(t){var n=t.collapseToSingleElement(),r=i.findClosestElementAncestor(n,e.rootNode,"blockquote");if(r){for(n==r&&(n=i.wrap(i.toArray(n.childNodes)));i.isNodeInRegion(e,n)&&"BLOCKQUOTE"!=i.getTagOfNode(n);)n=i.splitBalancedNodeRange(n);i.isNodeInRegion(e,n)&&i.unwrap(n)}}))}t.default=function(e,t){var n=0==t?a:s;r.default(e,(function(e,r,a){for(var s=o.getSelectedBlockElementsInRegion(e),l=[[]],u=0;u<s.length;u++){var d=s[u].getStartNode(),c=i.createVListFromRegion(e,!0,d);if(c){for(l.push([]);s[u+1]&&c.contains(s[u+1].getStartNode());)u++;c.setIndentation(r,a,t),c.writeBack()}else l[l.length-1].push(s[u])}l.forEach((function(t){return n(e,t)}))}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(92),o=n(45);t.default=function(e){e.useExperimentFeatures()?r.default(e,2):(e.focus(),e.addUndoSnapshot((function(){return o.default(e,"insertUnorderedList")}),"Format"))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(92),o=n(45);t.default=function(e){e.useExperimentFeatures()?r.default(e,1):(e.focus(),e.addUndoSnapshot((function(){return o.default(e,"insertOrderedList")}),"Format"))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(93),o=function(e){e.style.borderLeft="3px solid",e.style.borderColor="#C8C8C8",e.style.paddingLeft="10px",e.style.color="#666666"};t.default=function(e,t){r.default(e,"blockquote",t||o)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(93),o=n(0);function i(e){var t=o.wrap(e,"code");return o.wrap(t,"pre")}function a(e){if(!e)return null;var t=e.childNodes[0];return 1==e.childNodes.length&&"CODE"==o.getTagOfNode(t)&&o.unwrap(t),o.unwrap(e)}t.default=function(e,t){r.default(e,"pre",t,i,a)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(10);t.default=function(e){r.default(e,"strikeThrough")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(10);t.default=function(e){r.default(e,"subscript")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(10);t.default=function(e){r.default(e,"superscript")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e,t){t=Math.min(Math.max(Math.round(t),0),6),e.addUndoSnapshot((function(){e.focus();var n=!1;if(e.queryElements("H1,H2,H3,H4,H5,H6",1,(function(t){n||(e.getDocument().execCommand("formatBlock",!1,"<DIV>"),n=!0);for(var r=e.getDocument().createElement("div");t.firstChild;)r.appendChild(t.firstChild);e.replaceNode(t,r)})),t>0){for(var o=e.getSelectionTraverser(),i=o?o.currentBlockElement:null,a=new r.HtmlSanitizer({styleCallbacks:{"font-size":function(){return!1}}});i;){var s=i.collapseToSingleElement();a.sanitize(s),i=o.getNextBlockElement()}e.getDocument().execCommand("formatBlock",!1,"<H"+t+">")}}),"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(2),i=n(17);function a(e,t,n){return{winKey:e,macKey:t,action:n}}var s=[a(322,578,i.toggleBold),a(329,585,i.toggleItalic),a(341,597,i.toggleUnderline),a(346,602,(function(e){return e.undo()})),a(345,1626,(function(e){return e.redo()})),a(446,702,i.toggleBullet),a(447,703,i.toggleNumbering),a(1470,1726,(function(e){return i.changeFontSize(e,0)})),a(1468,1724,(function(e){return i.changeFontSize(e,1)}))];function l(e){return o.cacheGetEventData(e,"DEFAULT_SHORT_COMMAND",(function(){var t=e.rawEvent,n=0!=e.eventType||t.altKey?0:t.which|(t.metaKey&&512)|(t.shiftKey&&1024)|(t.ctrlKey&&256);return n&&s.filter((function(e){return(r.Browser.isMac?e.macKey:e.winKey)==n}))[0]}))}t.DefaultShortcut={allowFunctionKeys:!0,keys:[66,73,85,89,90,188,190,191],shouldHandleEvent:l,handleEvent:function(e,t){var n=l(e);n&&(n.action(t),e.rawEvent.preventDefault(),e.rawEvent.stopPropagation())}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),o=n(0),i=o.Browser.isEdge?"<div><span><br></span></div>":"<div><br></div>",a={TD:"TABLE",TH:"TABLE",LI:"OL,UL"},s=Object.keys(a).join(",");function l(e,t){return r.cacheGetEventData(e,"FIRST_STRUCTURE",(function(){var n=e.rawEvent.shiftKey?null:t.getElementAtCursor(s);if(n){var r=t.getSelectionRange();if(r&&r.collapsed&&o.isPositionAtBeginningOf(o.Position.getStart(r),n)&&!t.getBodyTraverser(n).getPreviousBlockElement())return t.getElementAtCursor(a[o.getTagOfNode(n)])}return null}))}t.InsertLineBeforeStructuredNodeFeature={keys:[13],shouldHandleEvent:l,handleEvent:function(e,t){var n=l(e,t),r=o.fromHtml(i,t.getDocument())[0];t.addUndoSnapshot((function(){n.parentNode.insertBefore(r,n),"TABLE"==o.getTagOfNode(n)&&t.select(new o.Position(r,0).normalize())})),e.rawEvent.preventDefault()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.NoCycleCursorMove={keys:[37,39],allowFunctionKeys:!0,shouldHandleEvent:function(e,t,n){var o,i;if(!(n&&(o=t.getSelectionRange())&&o.collapsed&&(i=r.Position.getStart(o))&&t.isPositionAtBeginning(i)))return!1;var a=r.isRtl(i.element),s=e.rawEvent;return!a&&37==s.which||a&&39==s.which},handleEvent:function(e){e.rawEvent.preventDefault()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),o=n(0);function i(e,t){return r.cacheGetEventData(e,"TABLECELL_FOR_TABLE_FEATURES",(function(){var e=t.getFocusedPosition(),n=e&&t.getElementAtCursor("TD,TH,LI",e.node);return n&&("LI"==o.getTagOfNode(n)?null:n)}))}t.TabInTable={keys:[9],shouldHandleEvent:i,handleEvent:function(e,t){for(var n=e.rawEvent.shiftKey,r=i(e,t),a=new o.VTable(r),s=n?-1:1,l=a.row,u=a.col+s;;u+=s){if(u<0||u>=a.cells[l].length){if((l+=s)<0||l>=a.cells.length){t.select(a.table,n?-2:-3);break}u=n?a.cells[l].length-1:0}var d=a.getCell(l,u);if(d.td){t.select(d.td,0);break}}e.rawEvent.preventDefault()}},t.UpDownInTable={keys:[38,40],shouldHandleEvent:i,handleEvent:function(e,t){for(var n=i(e,t),r=new o.VTable(n),a=38==e.rawEvent.which,s=a?-1:1,l=null,u=e.rawEvent.shiftKey,d=t.getSelection(),c=d.anchorNode,f=d.anchorOffset,p=r.row;p>=0&&p<r.cells.length;p+=s){var h=r.getCell(p,r.col);if(h.td&&h.td!=n){l=h.td;break}}t.runAsync((function(){var e=t.getElementAtCursor();if(o.contains(r.table,e)&&!o.contains(n,e,!0)){var i=l?new o.Position(l,0):new o.Position(r.table,a?-2:-3);u?(i=1==i.node.nodeType&&o.isVoidHtmlElement(i.node)?new o.Position(i.node,i.isAtEnd?-3:-2):i,t.getSelection().setBaseAndExtent(c,f,i.node,i.offset)):t.select(i)}}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(2);function i(e,t,n,r){return{keys:[e],shouldHandleEvent:function(e,n){return e.rawEvent.shiftKey===r&&!!a(e,n,t)},handleEvent:function(e,r){r.runAsync((function(){!function(e,t,n,r){t.performAutoComplete((function(){var o=a(e,t,n);if(o){var i=o.cloneRange();i.setStart(i.startContainer,i.startOffset+1),o.setEnd(o.endContainer,o.endOffset+1);var s=t.getDocument().createElement(r);s.appendChild(i.extractContents()),o.deleteContents();var l=t.getDocument().createTextNode("​");o.insertNode(l),o.insertNode(s),t.select(l,-1)}}),"Format")}(e,r,t,n)}))}}}function a(e,t,n){return o.cacheGetEventData(e,"MARKDOWN_RANGE",(function(){var i,a;return o.cacheGetContentSearcher(e,t).forEachTextInlineElement((function(e){if(a&&i)return!0;var t=e.getTextContent();if(0==t[t.length-1].trim().length)return!1;if(t[t.length-1]===n)return!1;if(a||(a=e.getStartPosition().move(t.length)),t[0]==n)i=e.getStartPosition();else for(var r=t.length-1;r>0;r--){if(i)return!0;if(t[r]==n&&0==t[r-1].trim().length)return i=e.getStartPosition().move(r),!0}})),!!i&&!!a&&r.createRange(i,a)}))}t.MarkdownBold=i(56,"*","b",!0),t.MarkdownItalic=i(189,"_","i",!0),t.MarkdownStrikethru=i(192,"~","s",!0),t.MarkdownInlineCode=i(192,"`","code",!1)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(17),o=n(0),i=n(2);function a(e,t){var n=s(e,t);if(n){var i=n[0],a=o.getTagOfNode(i);"UL"==a?r.toggleBullet(t):"OL"==a&&r.toggleNumbering(t),t.focus(),e.rawEvent.preventDefault()}}function s(e,t){var n=i.cacheGetElementAtCursor(t,e,"LI,TABLE"),r=n&&"LI"==o.getTagOfNode(n)&&t.getElementAtCursor("UL,OL",n);return r?[r,n]:null}t.IndentWhenTab={keys:[9],shouldHandleEvent:function(e,t){return!e.rawEvent.shiftKey&&s(e,t)},handleEvent:function(e,t){r.setIndentation(t,0),e.rawEvent.preventDefault()}},t.OutdentWhenShiftTab={keys:[9],shouldHandleEvent:function(e,t){return e.rawEvent.shiftKey&&s(e,t)},handleEvent:function(e,t){r.setIndentation(t,1),e.rawEvent.preventDefault()}},t.MergeInNewLine={keys:[8],shouldHandleEvent:function(e,t){var n=i.cacheGetElementAtCursor(t,e,"LI"),r=t.getSelectionRange();return n&&r&&o.isPositionAtBeginningOf(o.Position.getStart(r),n)},handleEvent:function(e,t){i.cacheGetElementAtCursor(t,e,"LI").previousSibling?t.runAsync((function(){var e=t.getDocument().createElement("BR");t.insertNode(e),t.select(e,-3)})):a(e,t)}},t.OutdentWhenBackOn1stEmptyLine={keys:[8],shouldHandleEvent:function(e,t){var n=i.cacheGetElementAtCursor(t,e,"LI");return n&&o.isNodeEmpty(n)&&!n.previousSibling},handleEvent:a},t.OutdentWhenEnterOnEmptyLine={keys:[13],shouldHandleEvent:function(e,t){var n=i.cacheGetElementAtCursor(t,e,"LI");return!e.rawEvent.shiftKey&&n&&o.isNodeEmpty(n)},handleEvent:function(e,t){t.performAutoComplete((function(){return a(e,t)}))}},t.AutoBullet={keys:[32],shouldHandleEvent:function(e,t){if(!s(e,t)){var n=i.cacheGetContentSearcher(e,t),r=n.getSubStringBefore(3);return["*","-","1."].indexOf(r)>=0&&!n.getNearestNonTextInlineElement()}return!1},handleEvent:function(e,t){t.runAsync((function(){t.performAutoComplete((function(){var e=t.getContentSearcherOfCursor(),n=e.getSubStringBefore(3),o=e.getRangeFromText(n,!0);if(o){o.deleteContents();var i=o.startContainer;if(3==(null==i?void 0:i.nodeType)&&""==i.nodeValue&&!i.previousSibling&&!i.nextSibling){var a=t.getDocument().createElement("BR");t.insertNode(a),t.select(a,-2)}}0==n.indexOf("1.")?r.toggleNumbering(t):r.toggleBullet(t)}))}))}},t.getSmartOrderedList=function(e){return{keys:[2048],shouldHandleEvent:function(e,t){return o.isHTMLOListElement(e.data)},handleEvent:function(t,n){var r=t.data,o=n.getElementAtCursor("OL",r.parentNode);if(o){var i=e&&e.length>0?e:["decimal"];r.style.listStyle=i[(i.indexOf(o.style.listStyle)+1)%i.length]}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),o=n(0),i="BLOCKQUOTE",a=[i,"LI","TD","TH"].join(",");function s(e,t){return r.cacheGetEventData(e,"QUOTE_CHILD",(function(){var e=t.getElementAtCursor(a);if(e&&o.getTagOfNode(e)==i){var n=t.getFocusedPosition(),r=n&&t.getBlockElementAtNode(n.normalize().node);if(r){var s=r.getStartNode()==e?r.getStartNode():r.collapseToSingleElement();return o.isNodeEmpty(s)?s:null}}return null}))}function l(e,t){t.addUndoSnapshot((function(){var n,r=s(e,t);o.getTagOfNode(r)==i&&(r=o.wrap(o.toArray(r.childNodes))),n=o.splitBalancedNodeRange(r),o.unwrap(n),t.select(r,0)})),e.rawEvent.preventDefault()}t.UnquoteWhenBackOnEmpty1stLine={keys:[8],shouldHandleEvent:function(e,t){var n=s(e,t);return n&&o.isNodeEmpty(n)&&!n.previousSibling},handleEvent:l},t.UnquoteWhenEnterOnEmptyLine={keys:[13],shouldHandleEvent:function(e,t){var n=s(e,t);return!e.rawEvent.shiftKey&&n&&o.isNodeEmpty(n)},handleEvent:function(e,t){return t.performAutoComplete((function(){return l(e,t)}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(183))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(184);t.CustomReplace=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),o=function(e,t,n){return{sourceString:e,replacementHTML:t,matchSourceCaseSensitive:n}},i=[o(":)","🙂",!0),o(";)","😉",!0),o(":O","😲",!0),o(":o","😯",!0),o("<3","❤️",!0)],a=function(){function e(e){void 0===e&&(e=i),this.updateReplacements(e)}return e.prototype.updateReplacements=function(e){var t;this.replacements=e,this.longestReplacementLength=(t=this.replacements,Math.max.apply(null,t.map((function(e){return e.sourceString.length})))),this.replacementEndCharacters=function(e){for(var t=new Set,n=0,r=e;n<r.length;n++){var o=r[n],i=o.sourceString;if(0!=i.length){var a=i[i.length-1];o.matchSourceCaseSensitive?t.add(a):(t.add(a.toLocaleLowerCase()),t.add(a.toLocaleUpperCase()))}}return t}(this.replacements)},e.prototype.getName=function(){return"CustomReplace"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){var t=this;if(!this.editor.isInIME()&&12==e.eventType&&(e.rawEvent.data&&this.replacementEndCharacters.has(e.rawEvent.data)&&null!=this.editor.getSelectionRange())){var n=r.cacheGetContentSearcher(e,this.editor),o=n.getSubStringBefore(this.longestReplacementLength),i=this.getMatchingReplacement(o);if(null!=i){var a=n.getSubStringBefore(i.sourceString.length),s=n.getRangeFromText(a,!0),l=this.editor.getDocument().createElement("span");l.innerHTML=i.replacementHTML;var u=1==l.childNodes.length?l.childNodes[0]:l;this.editor.performAutoComplete((function(){s.deleteContents(),s.insertNode(u),t.editor.select(u,-1)}))}}},e.prototype.getMatchingReplacement=function(e){if(0==e.length)return null;for(var t=e.toLocaleLowerCase(),n=0,r=this.replacements;n<r.length;n++){var o=r[n],i=o.matchSourceCaseSensitive?[e,o.sourceString]:[t,o.sourceString.toLocaleLowerCase()],a=i[0],s=i[1];if(a.substring(a.length-s.length)==s)return o}return null},e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(186))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(187);t.HyperLink=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(2),i=function(){function e(e,t,n){var r=this;void 0===e&&(e=function(e){return e}),this.getTooltipCallback=e,this.target=t,this.onLinkClick=n,this.onMouse=function(e){var t=r.editor.getElementAtCursor("a[href]",e.target),n=r.tryGetHref(t);n&&r.editor.setEditorDomAttribute("title","mouseover"==e.type?r.getTooltipCallback(n,t):null)}}return e.prototype.getName=function(){return"Hyperlink"},e.prototype.initialize=function(e){this.editor=e,this.disposer=this.getTooltipCallback&&e.addDomEventHandler({mouseover:this.onMouse,mouseout:this.onMouse})},e.prototype.dispose=function(){this.disposer&&(this.disposer(),this.disposer=null),this.editor=null},e.prototype.onPluginEvent=function(e){if(5==e.eventType){var t=this.editor.getElementAtCursor("A",e.rawEvent.srcElement);if(t){if(this.onLinkClick&&!1!==this.onLinkClick(t,e.rawEvent))return;var n=void 0;if(!r.Browser.isFirefox&&(n=this.tryGetHref(t))&&o.isCtrlOrMetaPressed(e.rawEvent)&&0===e.rawEvent.button)try{var i=this.target||"_blank";this.editor.getDocument().defaultView.open(n,i)}catch(e){}}}},e.prototype.tryGetHref=function(e){try{return e?e.href:null}catch(e){}},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(189))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(190);t.ImageResize=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o="RoosterJsImageResizingBegin",i="RoosterJsImageResizingEnd",a=new RegExp("\x3c!--"+o+"--\x3e[\\s\\S]*(<img\\s[^>]+>)[\\s\\S]*\x3c!--"+i+"--\x3e","gim"),s=function(){function e(e,t,n,r,a){var s=this;void 0===e&&(e=10),void 0===t&&(t=10),void 0===n&&(n="#DB626C"),void 0===r&&(r=!1),void 0===a&&(a="img"),this.minWidth=e,this.minHeight=t,this.selectionBorderColor=n,this.forcePreserveRatio=r,this.resizableImageSelector=a,this.startResize=function(e){var t=s.getSelectedImage();if(s.editor&&t){s.startPageX=e.pageX,s.startPageY=e.pageY,s.startWidth=t.clientWidth,s.startHeight=t.clientHeight,s.editor.addUndoSnapshot();var n=s.editor.getDocument();n.addEventListener("mousemove",s.doResize,!0),n.addEventListener("mouseup",s.finishResize,!0),s.direction=(e.srcElement||e.target).style.cursor}s.stopEvent(e)},this.doResize=function(e){var t=s.getSelectedImage();if(s.editor&&t){var n=e.pageX-s.startPageX,r=e.pageY-s.startPageY,o=Math.max(s.startWidth+(s.isWest(s.direction)?-n:n),s.minWidth),i=Math.max(s.startHeight+(s.isNorth(s.direction)?-r:r),s.minHeight);if(s.forcePreserveRatio||e.shiftKey)(a=s.startWidth>0&&s.startHeight>0?1*s.startWidth/s.startHeight:0)>0&&(o<i*a?o=i*a:i=o/a);if(t.style.width=o+"px",t.style.height=i+"px",s.forcePreserveRatio||e.shiftKey){var a=s.startWidth>0&&s.startHeight>0?1*s.startWidth/s.startHeight:0,l=Math.floor(t.clientWidth),u=Math.floor(t.clientHeight);o=Math.floor(o),u===(i=Math.floor(i))&&l===o||(u<i?o=u*a:i=l/a,t.style.width=o+"px",t.style.height=i+"px")}}s.stopEvent(e)},this.finishResize=function(e){var t=s.getSelectedImage();if(s.editor&&t){var n=s.editor.getDocument();n.removeEventListener("mousemove",s.doResize,!0),n.removeEventListener("mouseup",s.finishResize,!0);var r=t.clientWidth,o=t.clientHeight;t.style.width=r+"px",t.style.height=o+"px",t.width=r,t.height=o,s.resizeDiv.style.width="",s.resizeDiv.style.height=""}s.direction=null,s.editor.addUndoSnapshot(),s.editor.triggerContentChangedEvent("ImageResize"),s.stopEvent(e)},this.stopEvent=function(e){e.stopPropagation(),e.preventDefault()},this.removeResizeDivIfAny=function(e){var t=e&&e.parentNode,n=t&&t.previousSibling,r=t&&t.nextSibling;n&&8==n.nodeType&&n.nodeValue==o&&r&&8==r.nodeType&&r.nodeValue==i&&(t.parentNode.insertBefore(e,t),s.removeResizeDiv(t))},this.onBlur=function(e){s.hideResizeHandle()},this.onDragStart=function(e){(e.srcElement||e.target)==s.getSelectedImage()&&s.hideResizeHandle(!0)}}return e.prototype.getName=function(){return"ImageResize"},e.prototype.initialize=function(e){this.editor=e,this.disposer=e.addDomEventHandler({dragstart:this.onDragStart,blur:this.onBlur})},e.prototype.dispose=function(){this.resizeDiv&&this.hideResizeHandle(),this.disposer(),this.disposer=null,this.editor=null},e.prototype.onPluginEvent=function(e){var t=this;if(4==e.eventType){var n=e.rawEvent,o=n.srcElement||n.target;if("IMG"==r.getTagOfNode(o)){var i=o.parentNode;if((i?r.toArray(i.querySelectorAll(this.resizableImageSelector)):[]).indexOf(o)<0)return;o.contentEditable="false";var a=this.getSelectedImage();a&&a!=o&&this.hideResizeHandle(),this.resizeDiv||this.showResizeHandle(o)}else this.resizeDiv&&!r.contains(this.resizeDiv,o)&&this.hideResizeHandle()}else if(0==e.eventType&&this.resizeDiv){var s=e.rawEvent;46==s.which||8==s.which?(this.editor.addUndoSnapshot((function(){t.removeResizeDiv(t.resizeDiv)})),this.resizeDiv=null,s.preventDefault(),this.resizeDiv=null):16!=s.which&&17!=s.which&&18!=s.which&&this.hideResizeHandle(!0)}else if(6==e.eventType&&"ImageResize"!=e.source)this.editor.queryElements("img",this.removeResizeDivIfAny),this.resizeDiv=null;else if(7==e.eventType){var l=e;l.content=this.extractHtml(l.content)}},e.prototype.showResizeHandle=function(e){this.resizeDiv=this.createResizeDiv(e),e.contentEditable="false",this.editor.select(this.resizeDiv,-3)},e.prototype.hideResizeHandle=function(e){var t=this.getSelectedImage(),n=this.resizeDiv&&this.resizeDiv.parentNode;if(n){if(t){t.removeAttribute("contentEditable");var r=this.resizeDiv.previousSibling&&8==this.resizeDiv.previousSibling.nodeType?this.resizeDiv.previousSibling:this.resizeDiv;n.insertBefore(t,r),e?this.editor.select(t):this.editor.select(t,-3)}this.removeResizeDiv(this.resizeDiv),this.resizeDiv=null}},e.prototype.createResizeDiv=function(e){var t=this,n=this.editor.getDocument(),r=n.createElement("DIV"),a=e.parentNode;a.insertBefore(r,e),a.insertBefore(n.createComment(o),r),a.insertBefore(n.createComment(i),r.nextSibling),r.style.position="relative",r.style.display="inline-flex",r.contentEditable="false",r.addEventListener("click",this.stopEvent),r.appendChild(e),["nw","ne","sw","se"].forEach((function(e){var o=n.createElement("DIV");r.appendChild(o),o.style.position="absolute",o.style.width="7px",o.style.height="7px",o.style.backgroundColor=t.selectionBorderColor,o.style.cursor=e+"-resize",t.isNorth(e)?o.style.top="-3px":o.style.bottom="-3px",t.isWest(e)?o.style.left="-3px":o.style.right="-3px",o.addEventListener("mousedown",t.startResize)}));var s=n.createElement("DIV");return r.appendChild(s),s.style.position="absolute",s.style.top="0",s.style.left="0",s.style.right="0",s.style.bottom="0",s.style.border="solid 1px "+this.selectionBorderColor,s.style.pointerEvents="none",r},e.prototype.removeResizeDiv=function(e){var t=this;this.editor&&this.editor.contains(e)&&([e.previousSibling,e.nextSibling].forEach((function(e){e&&8==e.nodeType&&t.editor.deleteNode(e)})),this.editor.deleteNode(e))},e.prototype.extractHtml=function(e){return e.replace(a,(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e[1].replace(/(\s*contenteditable="false"(\/?>)|contenteditable="false"\s*)/im,"$2")}))},e.prototype.getSelectedImage=function(){return this.resizeDiv?this.resizeDiv.getElementsByTagName("IMG")[0]:null},e.prototype.isNorth=function(e){return e&&"n"==e.substr(0,1)},e.prototype.isWest=function(e){return e&&"w"==e.substr(1,1)},e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(192))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(193);t.Paste=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(194),o=n(195),i=n(0),a=n(96),s=n(199),l=function(){function e(e,t){this.attributeCallbacks=t}return e.prototype.getName=function(){return"Paste"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){var t=this;if(9==e.eventType){var n=e.htmlAttributes,l=e.fragment,u=e.sanitizingOption,d=void 0;"urn:schemas-microsoft-com:office:word"==n["xmlns:w"]?o.default(e):"urn:schemas-microsoft-com:office:excel"==n["xmlns:x"]||"Excel.Sheet"==n.ProgId?r.default(e):(d=l.querySelectorAll(a.WAC_IDENTIFING_SELECTOR))[0]?(d.forEach((function(e){e.style.display=null,e.style.margin=null})),s.isWordOnlineWithList(l)&&s.default(l)):l.querySelector("google-sheets-html-origin")&&u.additionalAllowedTags.push("google-sheets-html-origin"),this.attributeCallbacks&&Object.keys(this.attributeCallbacks).forEach((function(e){i.chainSanitizerCallback(u.attributeCallbacks,e,t.attributeCallbacks[e])}))}},e.prototype.pasteOriginal=function(e){this.editor.paste(e)},e.prototype.pasteText=function(e){this.editor.paste(e,!0)},e.prototype.pasteAndMergeFormat=function(e){this.editor.paste(e,!1,!0)},e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=/<\/\s*td\s*>((?!<\/\s*tr\s*>)[\s\S])*$/i,i=/<\/\s*tr\s*>((?!<\/\s*table\s*>)[\s\S])*$/i,a=/<tr[^>]*>[^<]*/i,s=/<table[^>]*>[^<]*/i;t.default=function(e){var t,n=e.fragment,l=e.sanitizingOption,u=e.htmlBefore,d=e.clipboardData.html,c=e.clipboardData.html;if(d.match(o)){var f=u.match(a);c=(f?f[0]:"<TR>")+d+"</TR>"}if(d.match(i)){var p=u.match(s);c=(p?p[0]:"<TABLE>")+d+"</TABLE>"}if(c!=d){for(var h=(new DOMParser).parseFromString(c,"text/html");n.firstChild;)n.removeChild(n.firstChild);for(;null===(t=null==h?void 0:h.body)||void 0===t?void 0:t.firstChild;)n.appendChild(h.body.firstChild)}r.chainSanitizerCallback(l.elementCallbacks,"TD",(function(e){return"none"==e.style.borderStyle&&(e.style.border="solid 1px #d4d4d4"),!0}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(196),i=n(197),a=n(198);t.default=function(e){var t=e.sanitizingOption,n=e.fragment;r.chainSanitizerCallback(t.elementCallbacks,"O:P",(function(e){return e.innerHTML="&nbsp;",!0}));var s=o.createWordConverter(),l=n.querySelectorAll("p");l.length>0&&(s.wordConverterArgs=i.createWordConverterArguments(l),a.processNodesDiscovery(s)&&a.processNodeConvert(s))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(94);t.createWordConverter=function(){return{nextUniqueId:1,numBulletsConverted:0,numNumberedConverted:0,wordConverterArgs:null,customData:r.createCustomData()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(95);t.createWordConverterArguments=function(e){return{nodes:e,currentIndex:0,lists:{},listItems:[],currentListIdsByLevels:[r.createLevelLists()],lastProcessedItem:null}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(95),o=n(94),i=n(0),a=/[\n|\r]/gi;function s(e,t,n,r){var a=function e(t,n,r){var o,a=null;1==n?o=p(t):(a=e(t,n-1,null),o=a.lastChild);if(o&&1==o.nodeType){var s=i.getTagOfNode(o);if("UL"==s||"OL"==s)return o}var l=t.ownerDocument.createElement(r?r.tagName:"UL");1==n?t.parentNode.insertBefore(l,t):a.appendChild(l);return l}(t,n.level,r),s=o.getObject(e.customData,a,"UniqueListId");if(s&&s!=n.uniqueListId||!s&&a.firstChild){var l=t.ownerDocument.createElement(r.tagName);a.parentNode.insertBefore(l,a.nextSibling),a=l}return o.setObject(e.customData,a,"UniqueListId",n.uniqueListId),function(e,t,n){if(n.tagName!=i.getTagOfNode(t)){var r=t.ownerDocument.createElement(n.tagName);for(o.setObject(e.customData,r,"UniqueListId",o.getObject(e.customData,t,"UniqueListId"));t.firstChild;)r.appendChild(t.firstChild);t.parentNode.insertBefore(r,t),t.parentNode.removeChild(t),t=r}return t}(e,a,r)}function l(e,t){for(var n=[],r=e.firstChild;r;r=r.nextSibling)1==r.nodeType&&t>1&&l(r,t-1),(g(r=f(r,!0))||v(r))&&n.push(r);n.forEach((function(t){return e.removeChild(t)}))}function u(e){if(1==e.nodeType){var t=m(e,"mso-list");if(t&&t.length>0)try{var n=t.split(" ");if(3==n.length)return{level:parseInt(n[1].substr("level".length)),wordListId:t,originalNode:e,uniqueListId:0}}catch(e){}}return null}function d(e){return["o","·","§","-"].indexOf(e)>=0}function c(e,t){for(var n=null,r=e.firstChild;!n&&r;)v(r=f(r,!0))?0==(n=r.textContent.trim()).length&&(n="o"):1==r.nodeType&&t>1&&(n=c(r,t-1)),r=r.nextSibling;return n}function f(e,t){if(8==e.nodeType){var n=e.data;if(n&&"[if !supportlists]"==n.trim().toLowerCase()){for(var r=e,o=null,i=0;i<4&&(r=h(r));i++)if(8==r.nodeType&&(n=r.data)&&"[endif]"==n.trim().toLowerCase()){o=r;break}if(o){var a=e.ownerDocument.createElement("span");for(a.setAttribute("style","mso-list: ignore"),r=h(e);r!=o;)r=r.nextSibling,a.appendChild(r.previousSibling);o.parentNode.insertBefore(a,o),t&&(e.parentNode.removeChild(e),o.parentNode.removeChild(o)),e=a}}}return e}function p(e){var t=e;do{t=t.previousSibling}while(t&&y(t));return t}function h(e){var t=e;do{t=t.nextSibling}while(t&&y(t));return t}function v(e){if(1==e.nodeType){var t=m(e,"mso-list");if(t&&t.length>0&&"ignore"==t.trim().toLowerCase())return!0}return!1}function g(e){return"SPAN"==i.getTagOfNode(e)&&!e.firstChild}function m(e,t){var n=e.getAttribute("style");if(n&&n.length>0&&n.indexOf(t)>=0)for(var r=n.split(";"),o=0;o<r.length;o++){var i=r[o].split(":");if(2==i.length&&i[0].trim()==t)return i[1].trim()}return null}function y(e){if(!e)return!0;if(3==e.nodeType){var t=e.nodeValue;return 0==(t=t.replace(a,"")).trim().length}var n=i.getTagOfNode(e);return e.firstChild==e.lastChild&&("SPAN"==n||"FONT"==n)&&y(e.firstChild)}function E(e){for(var t=0;t<e.currentListIdsByLevels.length;t++){var n=e.currentListIdsByLevels[t];n&&(n.currentUniqueListId=-1)}}t.processNodesDiscovery=function(e){for(var t,n=e.wordConverterArgs;n.currentIndex<n.nodes.length;){var o=n.nodes.item(n.currentIndex),i=u(o);if(i){var a=n.currentListIdsByLevels[i.level-1]||r.createLevelLists();n.currentListIdsByLevels[i.level-1]=a,n.lastProcessedItem&&p(o)!=n.lastProcessedItem&&E(n);var s=a.listsMetadata[i.wordListId];if(s){if(!s.ignore&&1==s.numberOfItems){var l=c(o,5);s.tagName=s.firstFakeBullet==l?"UL":"OL"}}else{var f=c(o,5);s={numberOfItems:0,uniqueListId:e.nextUniqueId++,firstFakeBullet:f,ignore:!f||0==f.length,tagName:(t=f,d(t)?"UL":"OL")},a.listsMetadata[i.wordListId]=s,n.lists[s.uniqueListId.toString()]=s}i.uniqueListId=s.uniqueListId,s.ignore||"OL"==s.tagName&&s.numberOfItems>0&&a.currentUniqueListId!=i.uniqueListId?(s.ignore=!0,n.currentListIdsByLevels[0].currentUniqueListId=-1,n.currentListIdsByLevels=n.currentListIdsByLevels.slice(0,1)):(n.currentListIdsByLevels.length>i.level&&(n.currentListIdsByLevels=n.currentListIdsByLevels.slice(0,i.level)),a.currentUniqueListId=i.uniqueListId,n.listItems.push(i),s.numberOfItems++),n.lastProcessedItem=o}else{var h=n.lastProcessedItem;if(h&&p(o)==h&&o.tagName==h.tagName&&o.className==h.className){for(h.appendChild(h.ownerDocument.createElement("br")),h.appendChild(h.ownerDocument.createElement("br"));null!=o.firstChild;)h.appendChild(o.firstChild);o.parentNode.removeChild(o)}}n.currentIndex++}return n.listItems.length>0},t.processNodeConvert=function(e){var t=e.wordConverterArgs;for(t.currentIndex=0;t.currentIndex<t.listItems.length;){var n=t.listItems[t.currentIndex],r=n.originalNode,o=t.lists[n.uniqueListId.toString()];if(!o.ignore){var i=s(e,r,n,o);if(i){l(r,5);for(var a=r.ownerDocument.createElement("LI");r.firstChild;)a.appendChild(r.firstChild);i.appendChild(a),r.parentNode.removeChild(r),"UL"==o.tagName?e.numBulletsConverted++:e.numNumberedConverted++}}t.currentIndex++}return e.numBulletsConverted>0||e.numNumberedConverted>0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(200),o=n(96),i=n(0);function a(e,t,n){if(e){var r,o=n.insertPositionNode;if(o)(r=o.parentElement)&&r.insertBefore(e,o);else(r=n.startElement.parentElement)?r.appendChild(e):t.appendChild(e)}}t.isWordOnlineWithList=function(e){return!(!e||!e.querySelector(o.WORD_ONLINE_IDENTIFYING_SELECTOR))},t.default=function(e){!function(e){e.querySelectorAll(o.WORD_ORDERED_LIST_SELECTOR+", "+o.WORD_UNORDERED_LIST_SELECTOR).forEach((function(e){var t=new RegExp("\\b"+o.LIST_CONTAINER_ELEMENT_CLASS_NAME+"\\b","g");if(e.previousSibling){var n=i.splitParentNode(e,!0);n.className=n.className.replace(t,"")}if(e.nextSibling){var r=i.splitParentNode(e,!1);r.className=r.className.replace(t,"")}}))}(e),function(e){for(var t,n=e.querySelectorAll("."+o.LIST_CONTAINER_ELEMENT_CLASS_NAME),a=[],s=0;s<n.length;s++){var l=n[s];if(t){var u=t.listItemContainers,d=u[u.length-1];l==d.nextSibling||i.getFirstLeafNode(l)==i.getNextLeafSibling(d.parentNode,d)?(u.push(l),t.endElement=l):(t.endElement=d,a.push(t),t=r.createListItemBlock(l))}else t=r.createListItemBlock(l)}t.listItemContainers.length>0&&a.push(t);return a}(e).forEach((function(t){var n;!function(e,t){i.collapseNodes(e,t.startElement,t.endElement,!0).forEach((function(e){"DIV"==i.getTagOfNode(e.firstChild)&&i.unwrap(e)}))}(e,t),t.insertPositionNode=t.endElement.nextSibling;var r=e.ownerDocument;t.listItemContainers.forEach((function(s){var l=function(e){var t=i.getTagOfNode(e.firstChild);return t==o.UNORDERED_LIST_TAG_NAME||t==o.ORDERED_LIST_TAG_NAME?t:null}(s);n||(n=r.createElement(l)),s.querySelectorAll("li").forEach((function(s){var u=parseInt(s.getAttribute("data-aria-level"));i.getTagOfNode(n)!=l&&1==u&&(a(n,e,t),n=r.createElement(l)),function(e,t,n,r){if(!n)return;var a=parseInt(t.getAttribute("data-aria-level")),s=e;for(;a>1;){if(s.firstChild){var l=s.lastElementChild,u=i.getTagOfNode(l);u==o.UNORDERED_LIST_TAG_NAME||u==o.ORDERED_LIST_TAG_NAME?s=l:(s.append(r.createElement(n)),s=s.lastElementChild)}else s.append(r.createElement(n)),s=s.firstElementChild;a--}s.appendChild(t)}(n,s,l,r)}))})),a(n,e,t);var s=t.startElement.parentNode;s&&t.listItemContainers.forEach((function(e){s.removeChild(e)}))}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createListItemBlock=function(e){return void 0===e&&(e=null),{startElement:e,endElement:e,insertPositionNode:null,listItemContainers:e?[e]:[]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(202))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(203);t.PickerPlugin=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(17),i=n(2),a=r.Browser.isIE?"Esc":"Escape",s=r.Browser.isIE?"Left":"ArrowLeft",l=r.Browser.isIE?"Up":"ArrowUp",u=r.Browser.isIE?"Right":"ArrowRight",d=r.Browser.isIE?"Down":"ArrowDown",c=r.Browser.isIE?"Del":"Delete",f=[0,229],p=function(){function e(e,t){this.dataProvider=e,this.pickerOptions=t,this.isPendingInputEventHandling=!1}return e.prototype.getName=function(){return"Picker"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.dataProvider.onInitalize((function(e){t.editor.focus();var n=t.getWord(null);n&&0!=n.length||!t.lastKnownRange||(t.editor.select(t.lastKnownRange),n=t.getWord(null));var r=function(){n?o.replaceWithNode(t.editor,n,e,!0):t.editor.insertNode(e),t.setIsSuggesting(!1)};t.pickerOptions.handleAutoComplete?t.editor.performAutoComplete(r,t.pickerOptions.changeSource):t.editor.addUndoSnapshot(r,t.pickerOptions.changeSource)}),(function(e){t.setIsSuggesting(e)}),e)},e.prototype.dispose=function(){this.editor=null,this.dataProvider.onDispose()},e.prototype.willHandleEventExclusively=function(e){return this.isSuggesting&&(0==e.eventType||2==e.eventType||12==e.eventType)},e.prototype.onPluginEvent=function(e){switch(e.eventType){case 6:if("SetContent"==e.source&&this.dataProvider.onContentChanged){this.isSuggesting&&this.setIsSuggesting(!1);var t=[];this.editor.queryElements("[id^='"+this.pickerOptions.elementIdPrefix+"']",(function(e){e.id&&t.push(e.id)})),this.dataProvider.onContentChanged(t)}break;case 0:this.eventHandledOnKeyDown=!1,this.isAndroidKeyboardEvent(e)?(this.currentInputLength=this.calcInputLength(e),this.isPendingInputEventHandling=!0):(this.onKeyDownEvent(e),this.isPendingInputEventHandling=!1);break;case 12:this.isPendingInputEventHandling&&this.onAndroidInputEvent(e);break;case 2:!this.eventHandledOnKeyDown&&this.shouldHandleKeyUpEvent(e)&&(this.onKeyUpDomEvent(e),this.isPendingInputEventHandling=!1);break;case 5:this.isSuggesting&&this.setIsSuggesting(!1);break;case 15:this.dataProvider.onScroll&&this.dataProvider.onScroll(e.scrollContainer)}},e.prototype.setLastKnownRange=function(e){this.lastKnownRange=e},e.prototype.setIsSuggesting=function(e){this.isSuggesting=e,e||this.setLastKnownRange(null),this.dataProvider.onIsSuggestingChanged(e),this.setAriaOwns(e),this.setAriaActiveDescendant(e?0:null)},e.prototype.cancelDefaultKeyDownEvent=function(e){this.eventHandledOnKeyDown=!0,e.rawEvent.preventDefault(),e.rawEvent.stopImmediatePropagation()},e.prototype.getIdValue=function(e){var t=e;return t.attributes&&t.attributes.getNamedItem("id")?t.attributes.getNamedItem("id").value:null},e.prototype.getWordBeforeCursor=function(e){var t=i.cacheGetContentSearcher(e,this.editor);return t?t.getWordBefore():null},e.prototype.replaceNode=function(e,t){e&&this.editor.deleteNode(e),t&&this.editor.insertNode(t)},e.prototype.getRangeUntilAt=function(e){var t,n,o=this;return i.cacheGetContentSearcher(e,this.editor).forEachTextInlineElement((function(e){for(var r=!1,i=e.getTextContent(),a=i?i.length:-1;a>=0;){if(i[a]==o.pickerOptions.triggerCharacter){t=e.getStartPosition().move(a),r=!0;break}a--}return r&&(n=e.getEndPosition()),r})),r.createRange(t,n)||this.editor.getDocument().createRange()},e.prototype.shouldHandleKeyUpEvent=function(e){return this.isAndroidKeyboardEvent(e)||i.isCharacterValue(e.rawEvent)||this.isSuggesting&&!i.isModifierKey(e.rawEvent)},e.prototype.onKeyUpDomEvent=function(e){if(this.isSuggesting){var t=(r=(n=this.getWord(e)).substring(1)).trim();n==this.pickerOptions.triggerCharacter||t&&t.length>0&&t.split(" ").length<=4?(this.dataProvider.queryStringUpdated(t,r==t),this.setLastKnownRange(this.editor.getSelectionRange())):this.setIsSuggesting(!1)}else{var n=this.getWordBeforeCursor(e);if(this.blockSuggestions)null!=n&&n[0]!=this.pickerOptions.triggerCharacter&&(this.blockSuggestions=!1);else if(null!=n&&n.split(" ").length<=4&&n[0]==this.pickerOptions.triggerCharacter){this.setIsSuggesting(!0);var r;t=(r=n.substring(1)).trim();if(this.dataProvider.queryStringUpdated(t,r==t),this.setLastKnownRange(this.editor.getSelectionRange()),this.dataProvider.setCursorPoint){var o=i.cacheGetContentSearcher(e,this.editor),a=this.editor.getDocument().createRange(),s=o.getInlineElementBefore().getContainerNode();if(!this.setRangeStart(a,s,n)){var l=s.previousSibling;this.setRangeStart(a,l,this.pickerOptions.triggerCharacter)}var u=a.getBoundingClientRect();if(0==u.left&&0==u.bottom&&0==u.top&&(u=a.getClientRects()[0]),u){a.detach();var d={x:u.left,y:(u.bottom+u.top)/2},c=(u.bottom-u.top)/2;this.dataProvider.setCursorPoint(d,c)}}}}},e.prototype.onKeyDownEvent=function(e){var t=e.rawEvent;if(this.isSuggesting)t.key==a?(this.setIsSuggesting(!1),this.blockSuggestions=!0,this.cancelDefaultKeyDownEvent(e)):this.dataProvider.shiftHighlight&&(this.pickerOptions.isHorizontal?t.key==s||t.key==u:t.key==l||t.key==d)?(this.dataProvider.shiftHighlight(this.pickerOptions.isHorizontal?t.key==u:t.key==d),this.dataProvider.getSelectedIndex&&this.setAriaActiveDescendant(this.dataProvider.getSelectedIndex()),this.cancelDefaultKeyDownEvent(e)):!this.dataProvider.selectOption||"Enter"!=t.key&&"Tab"!=t.key||(this.dataProvider.selectOption(),this.cancelDefaultKeyDownEvent(e));else if("Backspace"==t.key)this.tryRemoveNode(e)&&this.cancelDefaultKeyDownEvent(e);else if(t.key==c){var n=i.cacheGetContentSearcher(e,this.editor),r=n.getInlineElementAfter()?n.getInlineElementAfter().getContainerNode():null,o=r?this.getIdValue(r):null;if(o&&0==o.indexOf(this.pickerOptions.elementIdPrefix)){var f=this.dataProvider.onRemove(r,!1);this.replaceNode(r,f),this.cancelDefaultKeyDownEvent(e)}}},e.prototype.onAndroidInputEvent=function(e){(this.newInputLength=this.calcInputLength(e),this.newInputLength<this.currentInputLength||"deleteContentBackwards"===e.rawEvent.inputType)&&(this.tryRemoveNode(e)&&(this.eventHandledOnKeyDown=!0))},e.prototype.calcInputLength=function(e){var t=this.getInlineElementBeforeCursor(e);return t?t.length:0},e.prototype.tryRemoveNode=function(e){var t=this,n=i.cacheGetContentSearcher(e,this.editor),o=n.getInlineElementBefore(),a=o?o.getContainerNode():null,s=a?this.getIdValue(a):null,l=n.getInlineElementAfter();if(s&&0==s.indexOf(this.pickerOptions.elementIdPrefix)&&(null==l||!(l instanceof r.PartialInlineElement))){var u=this.dataProvider.onRemove(a,!0);return u?(this.replaceNode(a,u),this.isPendingInputEventHandling?this.editor.runAsync((function(){t.editor.select(u,-3)})):this.editor.select(u,-3)):this.editor.deleteNode(a),!0}return!1},e.prototype.getWord=function(e){var t=this.getRangeUntilAt(e).toString(),n=this.getWordBeforeCursor(e);return t==this.pickerOptions.triggerCharacter&&t!=n?n:t},e.prototype.setRangeStart=function(e,t,n){var r=t?t.textContent.lastIndexOf(n):-1;return r>-1&&(e.setStart(t,r),!0)},e.prototype.setAriaOwns=function(e){this.editor.setEditorDomAttribute("aria-owns",e&&this.pickerOptions.suggestionsLabel?this.pickerOptions.suggestionsLabel:null)},e.prototype.setAriaActiveDescendant=function(e){this.editor.setEditorDomAttribute("aria-activedescendant",null!=e&&this.pickerOptions.suggestionLabelPrefix?this.pickerOptions.suggestionLabelPrefix+e.toString():null)},e.prototype.getInlineElementBeforeCursor=function(e){var t=i.cacheGetContentSearcher(e,this.editor),n=t?t.getInlineElementBefore():null;return n?n.getTextContent():null},e.prototype.isAndroidKeyboardEvent=function(e){return"Unidentified"==e.rawEvent.key||null==e.rawEvent.key&&f.indexOf(e.rawEvent.charCode)>-1},e}();t.default=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(205))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(206);t.TableResize=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=function(){function e(){var e=this;this.pageX=-1,this.onMouseOver=function(t){var n=t.srcElement||t.target;e.pageX<0&&n&&("TD"==n.tagName||"TH"==n.tagName)&&n!=e.td&&(e.td=n,e.calcAndShowHandle())},this.onMouseDown=function(t){e.editor&&!e.editor.isDisposed()&&(e.pageX=t.pageX,e.initialPageX=t.pageX,e.attachMouseEvents(),e.getResizeHandle().style.borderWidth="0 1px",e.cancelEvent(t))},this.onMouseMove=function(t){e.adjustHandle(t.pageX),e.cancelEvent(t)},this.onMouseUp=function(t){e.detachMouseEvents(),e.getResizeHandle().style.borderWidth="0";var n=e.editor.getElementAtCursor("TABLE",e.td),o=parseInt(n.cellPadding);if(o=isNaN(o)?0:o,t.pageX!=e.initialPageX){var i=e.td.clientWidth-2*o+(t.pageX-e.initialPageX)*(r.isRtl(n)?-1:1);e.editor.addUndoSnapshot((function(t,n){e.setTableColumnWidth(i+"px"),e.editor.select(t,n)}),"Format")}e.pageX=-1,e.calcAndShowHandle(),e.editor.focus(),e.cancelEvent(t)}}return e.prototype.initialize=function(e){this.editor=e,this.onMouseOverDisposer=this.editor.addDomEventHandler("mouseover",this.onMouseOver)},e.prototype.getName=function(){return"TableResize"},e.prototype.dispose=function(){this.detachMouseEvents(),this.editor=null,this.onMouseOverDisposer()},e.prototype.onPluginEvent=function(e){this.td&&(0==e.eventType||6==e.eventType||4==e.eventType&&!this.clickIntoCurrentTd(e))&&(this.td=null,this.calcAndShowHandle())},e.prototype.clickIntoCurrentTd=function(e){var t=e.rawEvent.target;return r.isNode(t)&&r.contains(this.td,t,!0)},e.prototype.calcAndShowHandle=function(){if(this.td){var e=this.editor.getElementAtCursor("TR",this.td),t=this.editor.getElementAtCursor("TABLE",e);if(e&&t){var n=this.getPosition(t),o=n[0],i=n[1],a=this.getResizeHandle();o+=this.td.offsetLeft+(r.isRtl(t)?0:this.td.offsetWidth-6),a.style.display="",a.style.top=i+"px",a.style.height=t.offsetHeight+"px",a.style.left=o+"px"}}else this.getResizeHandle().style.display="none"},e.prototype.adjustHandle=function(e){var t=this.getResizeHandle();t.style.left=t.offsetLeft+e-this.pageX+"px",this.pageX=e},e.prototype.getPosition=function(e){var t=e.offsetParent,n=t?this.getPosition(t):[0,0],r=n[0],o=n[1];return[r+e.offsetLeft-e.scrollLeft,o+e.offsetTop-e.scrollTop]},e.prototype.getResizeHandle=function(){var e=this;return this.editor.getCustomData("TABLE_RESIZE_HANDLE",(function(){var t=e.editor.getDocument(),n=r.fromHtml('<div style="position: fixed; cursor: col-resize; width: 6px; border: solid 0 #C6C6C6;"></div>',t)[0];return e.editor.insertNode(n,{position:4,updateCursor:!1,replaceSelection:!1,insertOnNewLine:!1}),n.addEventListener("mousedown",e.onMouseDown),n}),(function(t){t.removeEventListener("mousedown",e.onMouseDown),t.parentNode.removeChild(t)}))},e.prototype.cancelEvent=function(e){e.stopPropagation(),e.preventDefault()},e.prototype.attachMouseEvents=function(){if(this.editor&&!this.editor.isDisposed()){var e=this.editor.getDocument();e.addEventListener("mousemove",this.onMouseMove,!0),e.addEventListener("mouseup",this.onMouseUp,!0)}},e.prototype.detachMouseEvents=function(){if(this.editor&&!this.editor.isDisposed()){var e=this.editor.getDocument();e.removeEventListener("mousemove",this.onMouseMove,!0),e.removeEventListener("mouseup",this.onMouseUp,!0)}},e.prototype.setTableColumnWidth=function(e){var t=this,n=new r.VTable(this.td);return n.table.style.width="",n.table.width="",n.forEachCellOfCurrentColumn((function(n){n.td&&(n.td.style.width=n.td==t.td?e:"")})),n.writeBack(),this.editor.contains(this.td)?this.td:n.getCurrentTd()},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(208))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(209);t.Watermark=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=new RegExp("<span[^>]*id=['\"]?_rooster_watermarkSpan['\"]?[^>]*>[^<]*</span>","ig"),i=function(){function e(e,t){var n=this;this.watermark=e,this.format=t,this.handleWatermark=function(){n.showHideWatermark(!1)},this.format=this.format||{fontSize:"14px",textColor:"#aaa"}}return e.prototype.getName=function(){return"Watermark"},e.prototype.initialize=function(e){this.editor=e,this.disposer=this.editor.addDomEventHandler({focus:this.handleWatermark,blur:this.handleWatermark}),this.spellcheckInitialValue=this.editor.getEditorDomAttribute("spellcheck")},e.prototype.dispose=function(){this.disposer(),this.disposer=null,this.hideWatermark(),this.editor=null},e.prototype.onPluginEvent=function(e){10==e.eventType?this.showHideWatermark(!1):6==e.eventType?this.showHideWatermark("SetContent"==e.source):7==e.eventType&&this.isWatermarkShowing&&this.removeWartermarkFromHtml(e)},e.prototype.showHideWatermark=function(e){this.editor.hasFocus()&&(e||this.isWatermarkShowing)?(this.hideWatermark(),this.editor.focus()):this.editor.hasFocus()||!e&&this.isWatermarkShowing||!this.editor.isEmpty(!0)||this.showWatermark()},e.prototype.showWatermark=function(){var e=this.editor.getDocument(),t=r.wrap(e.createTextNode(this.watermark),'<span id="_rooster_watermarkSpan"></span>');r.applyFormat(t,this.format,this.editor.isDarkMode()),this.editor.insertNode(t,{position:0,updateCursor:!1,replaceSelection:!1,insertOnNewLine:!1}),this.editor.setEditorDomAttribute("spellcheck","false"),this.isWatermarkShowing=!0},e.prototype.hideWatermark=function(){var e=this;this.editor.queryElements('span[id="_rooster_watermarkSpan"]',(function(t){var n=t.parentNode;e.editor.deleteNode(t),e.editor.contains(n)&&"DIV"==r.getTagOfNode(n)&&!n.firstChild&&n.appendChild(e.editor.getDocument().createElement("BR"))})),this.editor.setEditorDomAttribute("spellcheck",this.spellcheckInitialValue),this.isWatermarkShowing=!1},e.prototype.removeWartermarkFromHtml=function(e){var t=e.content;t=t.replace(o,""),e.content=t},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(211))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(212);t.EntityPlugin=r.default;var o=n(214);t.insertEntity=o.default;var i=n(20);t.getEntityFromElement=i.default;var a=n(97);t.getEntities=a.default;var s=n(31);t.getEntityElement=s.default;var l=n(99);t.createEntityWrapper=l.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(31),o=n(20),i=n(98),a=n(0),s=n(2),l=n(19),u=n(213),d=function(){function e(){var e=this;this.handleContextMenuEvent=function(t){var n=t.target,o=r.default(e.editor,n);o&&(t.preventDefault(),i.default(e.editor,o,2,t))},this.handleCutEvent=function(t){e.editor.getSelectionRange().collapsed||e.checkRemoveEntityForRange(t)}}return e.prototype.getName=function(){return"Entity"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.disposer=this.editor.addDomEventHandler({contextmenu:this.handleContextMenuEvent,cut:this.handleCutEvent}),this.knownEntityElements=[],[u.ClickOnEntityFeature,u.EscapeFromEntityFeature,u.EnterBeforeReadonlyEntityFeature,u.BackspaceAfterEntityFeature,u.DeleteBeforeEntityFeature].forEach((function(e){return t.editor.addContentEditFeature(e)}))},e.prototype.dispose=function(){this.disposer(),this.disposer=null,this.editor=null,this.knownEntityElements=null},e.prototype.onPluginEvent=function(e){switch(e.eventType){case 4:this.handleMouseDownEvent(e.rawEvent);break;case 5:this.handleMouseUpEvent(e.rawEvent);break;case 0:this.handleKeyDownEvent(e.rawEvent);break;case 9:this.handleBeforePasteEvent(e.fragment,e.sanitizingOption);break;case 6:this.handleContentChangedEvent("SetContent"==e.source);break;case 10:this.handleContentChangedEvent(!0);break;case 8:this.handleExtractContentWithDomEvent(e.clonedRoot)}},e.prototype.handleMouseDownEvent=function(e){var t=e.target,n=e.pageX,o=e.pageY,i=r.default(this.editor,t);i&&!i.isContentEditable&&(e.preventDefault(),this.clickingPoint={pageX:n,pageY:o})},e.prototype.handleMouseUpEvent=function(e){var t,n=e.target,o=e.pageX,a=e.pageY;this.clickingPoint&&this.clickingPoint.pageX==o&&this.clickingPoint.pageY==a&&(t=r.default(this.editor,n))&&(e.preventDefault(),i.default(this.editor,t,1,e),c(this.editor)),this.clickingPoint=null},e.prototype.handleKeyDownEvent=function(e){(s.isCharacterValue(e)||8==e.which||46==e.which)&&(this.editor.getSelectionRange().collapsed||this.checkRemoveEntityForRange(e))},e.prototype.handleBeforePasteEvent=function(e,t){var n=this;this.editor.getSelectionRange().collapsed||this.checkRemoveEntityForRange(null);var r=a.toArray(e.querySelectorAll(l.getEntitySelector()));if(r.length>0){var i=l.getAllEntityIds(this.editor);r.forEach((function(e){var t=o.default(e);t&&(e.className=l.serializeEntityInfo(n.editor,t.type,t.isReadonly,t.id,i))})),Array.prototype.push.apply(t.additionalAllowedCssClasses,l.ALLOWED_CSS_CLASSES)}},e.prototype.handleContentChangedEvent=function(e){var t=this;this.knownEntityElements=e?[]:this.knownEntityElements.filter((function(e){return t.editor.contains(e)})),this.editor.queryElements(l.getEntitySelector(),(function(e){t.knownEntityElements.indexOf(e)<0&&(t.knownEntityElements.push(e),i.default(t.editor,e,0))}))},e.prototype.handleExtractContentWithDomEvent=function(e){var t=this;a.toArray(e.querySelectorAll(l.getEntitySelector())).forEach((function(e){e.removeAttribute("contentEditable"),i.default(t.editor,e,8)}))},e.prototype.checkRemoveEntityForRange=function(e){var t=this,n=[],r=l.getEntitySelector();if(this.editor.queryElements(r,1,(function(r){r.isContentEditable?n.push(r):i.default(t.editor,r,6,e)})),n.length>0){var o=this.editor.queryElements(r,2);n.forEach((function(n){var r=o.indexOf(n)>=0;i.default(t.editor,n,r?6:7,e)}))}},e}();t.default=d;var c=a.Browser.isIE?function(e){e.runAsync((function(){var t=e.getCustomData("ENTITY_IE_FOCUS_BUTTON",(function(){var t=e.getDocument().createElement("button");return t.style.overflow="hidden",t.style.position="fixed",t.style.width="0",t.style.height="0",t.style.left="0",t.style.top="-1000px",t.onblur=function(){t.style.display="none"},e.insertNode(t,{position:4}),t}));t.style.display="";var n=e.getDocument().createRange();n.setStart(t,0);try{window.getSelection().removeAllRanges(),window.getSelection().addRange(n)}catch(e){}}))}:function(){}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(31),o=n(98),i=n(2),a=n(0);function s(e,t){return i.cacheGetEventData(e,"READONLY_ENTITY_ELEMENT",(function(){var n=r.default(t,e.rawEvent.target);return n&&!n.isContentEditable?n:null}))}function l(e,t,n,o,s){return i.cacheGetEventData(e,"NEIGHBOR_ENTITY_ELEMENT_"+n+"_"+o+"_"+!!s,(function(){var e=t.getSelectionRange();if(o&&!e.collapsed)return null;var i=a.Position.getEnd(e),l=!n&&(3!=i.node.nodeType||0==i.offset),u=null;if(n&&(3!=i.node.nodeType||i.isAtEnd)||l){var d=t.getBodyTraverser(i.node),c=l?d.getPreviousInlineElement():d.getNextInlineElement(),f=c&&c.getContainerNode();if(s){var p=t.getBlockElementAtNode(i.node);p&&p.contains(f)||(f=null)}u=r.default(t,f)}return u}))}t.ClickOnEntityFeature={keys:[13],shouldHandleEvent:s,handleEvent:function(e,t){var n=s(e,t);o.default(t,n,1,e.rawEvent)}},t.EscapeFromEntityFeature={keys:[27],shouldHandleEvent:s,handleEvent:function(e,t){var n=s(e,t);o.default(t,n,3,e.rawEvent)}},t.EnterBeforeReadonlyEntityFeature={keys:[13],shouldHandleEvent:function(e,t){return l(e,t,!0,!1,!0)},handleEvent:function(e,t){var n;e.rawEvent.preventDefault();var r=t.getSelectionRange(),o=a.Position.getEnd(r).normalize().node,i=t.getDocument().createElement("BR");o.parentNode.insertBefore(i,o.nextSibling);var s,l=t.getBlockElementAtNode(o);l&&(s=l.collapseToSingleElement(),null===(n=i.parentNode)||void 0===n||n.removeChild(i)),t.getSelectionRange().deleteContents(),s.nextSibling&&t.select(s.nextSibling,0)}},t.BackspaceAfterEntityFeature={keys:[8],shouldHandleEvent:function(e,t){return l(e,t,!1,!0)},handleEvent:function(e,t){var n=l(e,t,!1,!0);o.default(t,n,5,e.rawEvent)}},t.DeleteBeforeEntityFeature={keys:[46],shouldHandleEvent:function(e,t){return l(e,t,!0,!0)},handleEvent:function(e,t){var n=l(e,t,!0,!0);o.default(t,n,4,e.rawEvent)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(99),o=n(31),i=n(20),a=n(0);t.default=function(e,t,n,s,l,u){var d,c=r.default(e,t,n,s,l);if(u){d=e.getSelectionRange();var f=u.normalize().node,p=o.default(e,f);p&&(u=new a.Position(p,-3)),e.select(u)}if(e.insertNode(c,{updateCursor:!1,insertOnNewLine:s,replaceSelection:!0,position:3}),s){var h=e.getDocument().createElement("BR");c.parentNode.insertBefore(h,c.nextSibling)}d?e.select(d):s||e.select(c,-3);var v=i.default(c);return e.triggerContentChangedEvent("InsertEntity",v),v}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})}]);
//# sourceMappingURL=rooster-min.js.map